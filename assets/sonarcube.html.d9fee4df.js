import{_ as o,r,o as i,c as l,b as n,a as e,d as s,e as t}from"./app.afb6c0db.js";const c={},p=n("h1",{id:"\u4E32\u63A5-sonarcube-\u7B46\u8A18",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u4E32\u63A5-sonarcube-\u7B46\u8A18","aria-hidden":"true"},"#"),s(" \u4E32\u63A5 Sonarcube \u7B46\u8A18")],-1),u=n("p",null,"SonarQube \u662F\u4E00\u6B3E\u57FA\u65BC Java \u958B\u767C\u7684\u539F\u59CB\u78BC\u6AA2\u6E2C\u8207\u54C1\u8CEA\u7BA1\u7406\u7CFB\u7D71\uFF0C\u56E0\u8457 Java \u7684\u95DC\u4FC2\uFF0CServer \u8207 Client \u90FD\u662F\u8DE8\u5E73\u53F0\u7684",-1),d=n("h2",{id:"install",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#install","aria-hidden":"true"},"#"),s(" Install")],-1),h={href:"https://docs.sonarqube.org/latest/setup/get-started-2-minutes/#Installing%20a%20local%20instance%20of%20SonarQube",target:"_blank",rel:"noopener noreferrer"},v=s("Link"),k=t(`<h3 id="docker-image" tabindex="-1"><a class="header-anchor" href="#docker-image" aria-hidden="true">#</a> docker image</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker</span> run -d --name sonarqube -e <span class="token assign-left variable">SONAR_ES_BOOTSTRAP_CHECKS_DISABLE</span><span class="token operator">=</span>true -p <span class="token number">9000</span>:9000 sonarqube:latest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,2),_=s("\u524D\u5F80 "),m={href:"http://localhost:9000",target:"_blank",rel:"noopener noreferrer"},b=s("http://localhost:9000"),g=s(" \u958B\u555F Web \u4ECB\u9762"),f=n("h2",{id:"\u5EFA\u7ACB-sonarcube-\u5C08\u6848",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5EFA\u7ACB-sonarcube-\u5C08\u6848","aria-hidden":"true"},"#"),s(" \u5EFA\u7ACB sonarcube \u5C08\u6848")],-1),y=n("p",null,"\u5728 sonar \u4E0A\u5EFA\u7ACB manual project",-1),q=n("ol",null,[n("li",null,"Create new project - manual"),n("li",null,"\u8A2D\u5B9A Project key, Display name"),n("li",null,"\u7522\u751F\u4E00\u7D44 token \u4E26\u59A5\u5584\u4FDD\u5B58"),n("li",null,"\u57F7\u884C\u5206\u6790\u5C08\u6848\uFF0C\u6B64\u6B65\u9A5F\u9700\u4E0B\u8F09 scanner")],-1),j=n("h2",{id:"\u4E0B\u8F09-scanner",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u4E0B\u8F09-scanner","aria-hidden":"true"},"#"),s(" \u4E0B\u8F09 scanner")],-1),x=s("\u6839\u64DA\u74B0\u5883\u53EF\u4EE5"),S={href:"https://docs.sonarqube.org/latest/analysis/scan/sonarscanner/",target:"_blank",rel:"noopener noreferrer"},E=s("\u5728\u6B64"),R=s("\u4E0B\u8F09\u4E0D\u540C\u7684 scanner"),D=n("h2",{id:"ci-\u4E32\u63A5",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ci-\u4E32\u63A5","aria-hidden":"true"},"#"),s(" CI \u4E32\u63A5")],-1),N={href:"https://docs.sonarqube.org/latest/analysis/jenkins/",target:"_blank",rel:"noopener noreferrer"},C=s("Link"),P=n("p",null,"\u4EE5 Github \u8209\u4F8B",-1),O={href:"https://docs.sonarqube.org/latest/analysis/github-integration/",target:"_blank",rel:"noopener noreferrer"},A=s("Github integration"),B=t('<ol><li>\u5275\u5EFA Github App \u4E26\u5B89\u88DD\u5230\u76EE\u6A19\u5C08\u6848\u7684 Organization</li><li>\u8A2D\u5B9A sonarcube \u5C08\u6848</li></ol><h3 id="webhooks" tabindex="-1"><a class="header-anchor" href="#webhooks" aria-hidden="true">#</a> Webhooks</h3><p>\u52A0\u5165 PR Webhook</p><h3 id="pr-decoration" tabindex="-1"><a class="header-anchor" href="#pr-decoration" aria-hidden="true">#</a> PR Decoration</h3><p>sonar.com &gt; Your project &gt; Project Settings &gt; General Settings &gt; Pull Request Decoration</p><h3 id="quality-profiles" tabindex="-1"><a class="header-anchor" href="#quality-profiles" aria-hidden="true">#</a> Quality Profiles</h3><p>\u6839\u64DA\u5C08\u6848\u9700\u6C42\uFF0C\u5728\u8A2D\u5B9A\u9801\u9762\u88E1\u7684 <code>Quality Profiles</code> \u52A0\u5165\u5C0D\u6383\u63CF\u7684\u5957\u7528\u898F\u7BC4</p><ul><li>CSS: sonar way</li></ul><h2 id="\u8A2D\u5B9A-package-json-\u7522\u751F-coverage-report" tabindex="-1"><a class="header-anchor" href="#\u8A2D\u5B9A-package-json-\u7522\u751F-coverage-report" aria-hidden="true">#</a> \u8A2D\u5B9A package.json \u7522\u751F coverage report</h2>',9),L={href:"https://docs.sonarqube.org/latest/analysis/test-coverage/javascript-typescript-test-coverage/",target:"_blank",rel:"noopener noreferrer"},T=s("javascript-typescript-test-coverage"),I=t(`<div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;test:ci&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jest --ci --collectCoverage&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u8A2D\u5B9A-sonar-project-properties" tabindex="-1"><a class="header-anchor" href="#\u8A2D\u5B9A-sonar-project-properties" aria-hidden="true">#</a> \u8A2D\u5B9A sonar-project.properties</h2>`,2),G=s("\u5EFA\u7ACB\u5C08\u6848\u5F8C\uFF0C\u9700\u8981\u7522\u751F\u4E00\u7D44 "),Q=n("code",null,"sonar_login_token",-1),w=s(" \u4F7F\u7528\uFF0C\u4E26\u6839\u64DA"),U={href:"https://docs.sonarqube.org/8.9/analysis/analysis-parameters/",target:"_blank",rel:"noopener noreferrer"},V=s("\u9019\u500B\u6559\u5B78"),$=s("\u9032\u884C sonar \u7684 project \u914D\u7F6E"),H=t(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>sonar.host.url<span class="token operator">=</span>	http://localhost:9000
sonar.login<span class="token operator">=</span>your_login_token
sonar.projectBaseDir<span class="token operator">=</span>./
<span class="token comment"># sonar \u4E0A\u7684\u5C08\u6848\u540D\u7A31</span>
sonar.projectKey<span class="token operator">=</span>your_project_name

<span class="token comment"># test coverage report \u4F4D\u7F6E</span>
sonar.javascript.lcov.reportPaths<span class="token operator">=</span>coverage/lcov.info

<span class="token comment"># scanner \u898F\u5247\u8A2D\u5B9A</span>
sonar.sources<span class="token operator">=</span>src
sonar.eslint.eslintconfigpath<span class="token operator">=</span>.eslintrc.js
sonar.typescript.tsconfigPath<span class="token operator">=</span>tsconfig.json
sonar.coverage.exclusions<span class="token operator">=</span>**/node_modules/**, **.spec.ts, **.test.ts, **.spec.js, **.test.js, **/*.html, **/next.config.js

<span class="token comment"># Encoding of the source code. Default is default system encoding</span>
sonar.sourceEncoding<span class="token operator">=</span>UTF-8

<span class="token comment"># \u5C08\u6848\u4F4D\u7F6E</span>
sonar.analysis.repoLink<span class="token operator">=</span>path_to_your_repository
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u8A2D\u5B9A-drone-yml" tabindex="-1"><a class="header-anchor" href="#\u8A2D\u5B9A-drone-yml" aria-hidden="true">#</a> \u8A2D\u5B9A drone.yml</h2><p>\u4EE5\u4E0B\u7BC4\u4F8B\uFF0C\u914D\u7F6E jest \u7522\u751F report\uFF0C\u4E26\u63A5\u8457\u57F7\u884C sonar scan</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">kind</span><span class="token punctuation">:</span> pipeline
<span class="token key atrule">name</span><span class="token punctuation">:</span> default

<span class="token key atrule">trigger</span><span class="token punctuation">:</span>
  <span class="token key atrule">branch</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;precommit/*&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">event</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;push&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pull_request&quot;</span><span class="token punctuation">]</span>

<span class="token key atrule">steps</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> prepare
    <span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token string">&quot;node:16.13.1&quot;</span>
    <span class="token key atrule">commands</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;npm run lint&quot;</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;npm run test:ci&quot;</span>

  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> sonar<span class="token punctuation">-</span>scan
    <span class="token key atrule">image</span><span class="token punctuation">:</span> sonarsource/sonar<span class="token punctuation">-</span>scanner<span class="token punctuation">-</span>cli
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">SONAR_TOKEN</span><span class="token punctuation">:</span>
        <span class="token key atrule">from_secret</span><span class="token punctuation">:</span> sonar_login_token
    <span class="token key atrule">commands</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;sonar-scanner -Dsonar.pullrequest.key=$DRONE_PULL_REQUEST -Dsonar.pullrequest.branch=$DRONE_SOURCE_BRANCH -Dsonar.pullrequest.base=$DRONE_TARGET_BRANCH&quot;</span>
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> prepare
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4);function K(W,J){const a=r("ExternalLinkIcon");return i(),l("div",null,[p,u,d,n("ul",null,[n("li",null,[n("a",h,[v,e(a)])])]),k,n("p",null,[_,n("a",m,[b,e(a)]),g]),f,y,q,j,n("p",null,[x,n("a",S,[E,e(a)]),R]),D,n("ul",null,[n("li",null,[n("a",N,[C,e(a)])])]),P,n("ul",null,[n("li",null,[n("a",O,[A,e(a)])])]),B,n("ul",null,[n("li",null,[n("a",L,[T,e(a)])])]),I,n("p",null,[G,Q,w,n("a",U,[V,e(a)]),$]),H])}var F=o(c,[["render",K],["__file","sonarcube.html.vue"]]);export{F as default};
