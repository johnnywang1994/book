import{_ as Z,j as _,w as G,k as V,l as A,o as D,c as T,b as ee}from"./app-DSyX4Wk3.js";const x=30,$=10,k=.1,te={__name:"HomeBackground",setup(J,{expose:H}){var z,q;H();const P=(e,o=!1)=>new Promise(n=>{const s=document.createElement("img");s.src=e,s.crossOrigin=o?"anonymous":!1,s.onload=()=>n(s)}),p=(e,o,n,s)=>{const t=e-n,a=o-s,u=Math.sqrt(t**2+a**2);return{x:t,y:a,distance:u}},B=(e,o,n,s,t=4)=>{const a=n+t,u=s+t,c=t*t;let l=0,f=0,h=0,g=0;for(let C=n;C<a;C++)for(let S=s;S<u;S++){const E=(C*o+S)*4;l+=e[E],f+=e[E+1],h+=e[E+2],g+=e[E+3]}const Y=l/c,b=f/c,K=h/c,Q=g/c;return{x:s+t/2,y:n+t/2,originX:s+t/2,originY:n+t/2,color:`rgba(${Y}, ${b}, ${K}, ${Q/255})`}},i=_(null),R=_(null),F=_([]),L=_({x:1/0,y:1/0}),M=_(1),v=_();let y,r=(z=i.value)==null?void 0:z.width,d=(q=i.value)==null?void 0:q.height;const I=e=>{const o=Math.round(d/x),n=Math.round(r/x),s=[];for(let t=0;t<o;t++)for(let a=0;a<n;a++){const u=t*x,c=a*x,l=B(e,r,u,c,x);s.push(l)}return s},U=()=>{const e=R.value;e.clearRect(0,0,r,d),F.value.forEach(o=>{e.beginPath(),e.arc(o.x,o.y,x/2,0,Math.PI*2),e.fillStyle=o.color,e.fill()})},j=()=>{const e=F.value,o=L.value,{x:n,y:s}=o;e.forEach(t=>{const{x:a,y:u,distance:c}=p(n,s,t.x,t.y);if(c<y){const l=(y-c)/y,f=Math.atan2(u,a),h=Math.cos(f)*l*$,g=Math.sin(f)*l*$;t.x-=h,t.y-=g}else if(t.x!==t.originX||t.y!==t.originY){const{x:l,y:f,distance:h}=p(t.originX,t.originY,t.x,t.y),g=Math.atan2(f,l),Y=Math.cos(g)*h*k,b=Math.sin(g)*h*k;t.x+=Y,t.y+=b}})},O=()=>{j(),U(),requestAnimationFrame(O)},N=async e=>{const o=await P(e,!0),{width:n,height:s}=o,t=i.value;v.value=t.getBoundingClientRect(),M.value=n/v.value.width,r=t.width=n,d=t.height=s;const a=R.value;a.drawImage(o,0,0,r,d);const u=a.getImageData(0,0,r,d),c=I(u.data);F.value=c,O()},m=e=>{var a;const o=M.value,n=(a=e==null?void 0:e.touches)==null?void 0:a[0],s=v.value.top,t=v.value.left;L.value={x:((n==null?void 0:n.pageX)-t||e.offsetX)*o,y:((n==null?void 0:n.pageY)-s||e.offsetY)*o}},w=()=>{L.value={x:1/0,y:1/0}},X=()=>{const e=i.value;v.value=e.getBoundingClientRect(),M.value=r/v.value.width};G(i,()=>{const e=i.value;e&&(e.addEventListener("mousemove",m,{passive:!0}),e.addEventListener("mouseleave",w),e.addEventListener("touchstart",m,{passive:!0}),e.addEventListener("touchmove",m,{passive:!0}),e.addEventListener("touchend",w,{passive:!0}),window.addEventListener("resize",X,{passive:!0}))}),V(()=>{const e=i.value;e&&(e.removeEventListener("mousemove",m),e.removeEventListener("mouseleave",w),e.removeEventListener("touchstart",m),e.removeEventListener("touchmove",m),e.removeEventListener("touchend",w),window.removeEventListener("resize",X))}),A(()=>{y=window.innerWidth<576?300:200;const e=i.value;e&&(R.value=e.getContext("2d"),N("https://raw.githubusercontent.com/jwlearn1994/image-uploader/main/others/myblog/me2.jpeg"))});const W={loadImg:P,getDistance:p,getAveragePixelByRowCol:B,canvasRef:i,ctxRef:R,particlesRef:F,mousePositionRef:L,ratioRef:M,canvasRectRef:v,DIAMETER:x,get FORCE_RADIUS(){return y},set FORCE_RADIUS(e){y=e},FORCE_SPEED:$,RETURN_SPEED:k,get canvasWidth(){return r},set canvasWidth(e){r=e},get canvasHeight(){return d},set canvasHeight(e){d=e},convertToParticles:I,drawParticles:U,updateParticles:j,drawCanvas:O,initCanvas:N,handleMouseMove:m,handleMouseLeave:w,handleResize:X,ref:_,watch:G,onMounted:A,onBeforeUnmount:V};return Object.defineProperty(W,"__isScriptSetup",{enumerable:!1,value:!0}),W}},ne={class:"home-background"},se={ref:"canvasRef",style:{width:"100%"}};function oe(J,H,P,p,B,i){return D(),T("div",ne,[ee("canvas",se,null,512)])}const ce=Z(te,[["render",oe],["__file","HomeBackground.vue"]]);export{ce as default};
