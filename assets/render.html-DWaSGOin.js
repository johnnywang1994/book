import{_ as n,c as s,e as t,o as e}from"./app-Ba7lTalA.js";const l={};function p(i,a){return e(),s("div",null,a[0]||(a[0]=[t(`<h1 id="頁面渲染架構優化" tabindex="-1"><a class="header-anchor" href="#頁面渲染架構優化"><span>頁面渲染架構優化</span></a></h1><h2 id="瀏覽器頁面渲染流程" tabindex="-1"><a class="header-anchor" href="#瀏覽器頁面渲染流程"><span>瀏覽器頁面渲染流程</span></a></h2><ul><li>Browser 解析 HTML =&gt; 生成 DOM tree</li><li>Browser 解析 CSS =&gt; 生成 CSSOM(Object Model) tree</li><li>JS 透過 DOM API, CSSOM API 操作 DOM tree, CSSOM tree</li><li>Browser 將 DOM tree, CSSOM tree 合成 Render tree</li><li><code>Layout</code>: Browser 根據 Render tree 進行 reflow 計算每個元素尺寸、位置等幾何資訊</li><li><code>Painting</code>: Browser Render tree 及 reflow 獲得的幾何資訊，得到每個元素的絕對像素</li><li><code>Displaying</code>: Browser 將像素發給 GPU 圖形處理器，展示在畫面上</li></ul><h3 id="回流、重繪" tabindex="-1"><a class="header-anchor" href="#回流、重繪"><span>回流、重繪</span></a></h3><ul><li>回流(reflow)：指瀏覽器 render engine 根據元素尺寸、位置、顯示屬性重新計算頁面排版、佈局</li><li>重繪(repaint)：指瀏覽器 render engine 根據顯示屬性（顏色、文字大小）重新繪製元素，不影響尺寸、位置</li></ul><h2 id="頁面渲染架構" tabindex="-1"><a class="header-anchor" href="#頁面渲染架構"><span>頁面渲染架構</span></a></h2><ul><li>SSR: Server 端渲染（身份驗證、SEO、安全性）</li><li>SSG: Build Time 預渲染（靜態內容網站、內容少變動）</li><li>CSR: Client 端渲染（動態交互、核心業務）</li><li>Hybrid: Server with Client 端渲染（避免 CSR 白屏、增強 SEO、安全性）</li></ul><blockquote><p>各有優劣，架構選擇上需根據業務形式、團隊規模、技術水平等綜合考量決定</p></blockquote><h2 id="頁面載入策略優化" tabindex="-1"><a class="header-anchor" href="#頁面載入策略優化"><span>頁面載入策略優化</span></a></h2><ul><li>懶加載（延遲載入）：指長網頁中延遲載入某些元素（image/JS/CSS file 或特定函數等），減少首屏無效的資源載入浪費，常見許多第三方工具</li><li>預加載：指讓瀏覽器預先載入某些資源（image/JS/CSS），後續使用時就可以直接從 cache 中讀取，減少使用時的讀取等待時間</li><li>預渲染：對大型專案來說，在懶加載組件之前，可能還有其他依賴的懶加載組件或資料需要載入，用戶還是需要時間等待載入，另一種預加載組件的方式就是「預渲染」，在頁面中渲染組件但不顯示，而是先隱藏，等到要使用時才顯示</li><li>按需加載：現代打包工具內建支援 dynamic import，甚至可按需載入 api 資料結合本地 cache</li></ul><h3 id="預加載常用實現方式" tabindex="-1"><a class="header-anchor" href="#預加載常用實現方式"><span>預加載常用實現方式</span></a></h3><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html" data-title="html"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://demo.com/xxx.jpg<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> none</span><span class="token punctuation">&quot;</span></span></span> <span class="token punctuation">/&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>style<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>src.style.css<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>prefetch<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>src/image.png<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dns-prefetch<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://my.com<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preconnect<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://my.com<span class="token punctuation">&quot;</span></span> <span class="token attr-name">crossorigin</span> <span class="token punctuation">/&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&quot;https://demo.com/xxx.jpg&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="預渲染常用實現方式" tabindex="-1"><a class="header-anchor" href="#預渲染常用實現方式"><span>預渲染常用實現方式</span></a></h3><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html" data-title="html"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>prerender<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://my.com<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="pwa-progressive-web-app-原生應用" tabindex="-1"><a class="header-anchor" href="#pwa-progressive-web-app-原生應用"><span>PWA Progressive Web App 原生應用</span></a></h2><ul><li>預緩存資源、秒開頁面</li><li>降低網路依賴</li><li>沈浸式體驗</li><li>離線推送訊息</li></ul><h3 id="條件" tabindex="-1"><a class="header-anchor" href="#條件"><span>條件</span></a></h3><ul><li>HTTPS</li><li>Service Worker</li><li>App Manifest</li><li>離線推送(optional)</li></ul><h2 id="api-優化" tabindex="-1"><a class="header-anchor" href="#api-優化"><span>API 優化</span></a></h2><ul><li>API 合併：將多個 api 和第三方服務統一使用一個集群調用，減少頁面 api 請求數量</li><li>API 上 CDN：性能考慮，把不需要實時更新的 api 同步至 CDN，等內容變更後再自動同步到 CDN 上</li><li>API 降級：核心 API 降級，用基礎 API 進行業務實現（預設 fallback 的備份資料）</li><li>API 緩存 <ul><li>AJAX/fetch 緩存：前端 request 時帶上 &quot;cache&quot; 字頭，依賴瀏覽器本身 cache 機制</li><li>本地緩存：優先使用 localStorage 中的緩存</li></ul></li></ul>`,21)]))}const c=n(l,[["render",p],["__file","render.html.vue"]]),r=JSON.parse('{"path":"/articles/memo/fe-performance/render.html","title":"頁面渲染架構優化","lang":"zh-TW","frontmatter":{},"headers":[{"level":2,"title":"瀏覽器頁面渲染流程","slug":"瀏覽器頁面渲染流程","link":"#瀏覽器頁面渲染流程","children":[{"level":3,"title":"回流、重繪","slug":"回流、重繪","link":"#回流、重繪","children":[]}]},{"level":2,"title":"頁面渲染架構","slug":"頁面渲染架構","link":"#頁面渲染架構","children":[]},{"level":2,"title":"頁面載入策略優化","slug":"頁面載入策略優化","link":"#頁面載入策略優化","children":[{"level":3,"title":"預加載常用實現方式","slug":"預加載常用實現方式","link":"#預加載常用實現方式","children":[]},{"level":3,"title":"預渲染常用實現方式","slug":"預渲染常用實現方式","link":"#預渲染常用實現方式","children":[]}]},{"level":2,"title":"PWA Progressive Web App 原生應用","slug":"pwa-progressive-web-app-原生應用","link":"#pwa-progressive-web-app-原生應用","children":[{"level":3,"title":"條件","slug":"條件","link":"#條件","children":[]}]},{"level":2,"title":"API 優化","slug":"api-優化","link":"#api-優化","children":[]}],"git":{"updatedTime":1721122771000,"contributors":[{"name":"johnnywang","username":"johnnywang","email":"johnnywang@test.com","commits":1,"url":"https://github.com/johnnywang"}]},"filePathRelative":"articles/memo/fe-performance/render.md"}');export{c as comp,r as data};
