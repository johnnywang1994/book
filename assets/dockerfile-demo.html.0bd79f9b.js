import{_ as e,o as s,c as n,e as a}from"./app.e90a952f.js";const o={},c=a(`<h1 id="dockerfile-\u6280\u8853\u7BC7" tabindex="-1"><a class="header-anchor" href="#dockerfile-\u6280\u8853\u7BC7" aria-hidden="true">#</a> Dockerfile \u6280\u8853\u7BC7</h1><p>\u672C\u7BC7\u4E3B\u8981\u7D00\u9304dockerfile\u7684\u4F7F\u7528\u65B9\u6CD5\u8207\u7B46\u8A18</p><h2 id="basic-\u6982\u5FF5" tabindex="-1"><a class="header-anchor" href="#basic-\u6982\u5FF5" aria-hidden="true">#</a> Basic \u6982\u5FF5</h2><p>Docker \u80FD\u5920\u7D93\u7531 <code>Dockerfile</code> \u81EA\u52D5\u5316\u69CB\u5EFAimages\uFF0C<code>Dockerfile</code>\u70BA\u4E00\u500B\u6587\u672C\u6A94\uFF0C</p><p>\u5176\u4E2D\u5305\u542B\u6240\u6709\u4F7F\u7528\u8005\u53EF\u7528\u65BC\u69CB\u5EFA images \u7684\u6307\u4EE4\uFF0C\u900F\u904E<code>docker build</code>\u6307\u4EE4\uFF0C\u5373\u53EF\u81EA\u52D5\u5316\u69CB\u5EFA</p><p>images \uFF0C\u57F7\u884C\u539F\u672C\u9700\u8981\u6578\u884C\u7684\u6307\u4EE4\u3002</p><p>\u9810\u8A2D\u4E0A\uFF0CDockerfile \u5373\u547D\u540D\u70BA<code>Dockerfile</code> \u4E26\u7F6E\u65BC\u60A8\u5C08\u6848\u7684\u6839\u76EE\u9304\u4E2D\u3002</p><h2 id="\u4F7F\u7528\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528\u65B9\u6CD5" aria-hidden="true">#</a> \u4F7F\u7528\u65B9\u6CD5</h2><p>\u57F7\u884C <code>docker build</code> \u6307\u4EE4\u6642\uFF0C\u6703\u5C07 <code>Dockerfile</code> \u7684\u5167\u5BB9\u50B3\u7D66 Docker Daemon \u9032\u884C\u89E3\u6790\uFF0C</p><p>\u82E5\u65BC\u89E3\u6790\u6642\u767C\u751FSyntax\u7B49\u554F\u984C\uFF0C\u6703\u5373\u6642\u8DF3\u51FA ERROR\u3002</p><p>\u9810\u8A2D\u884C\u70BA\u4E0B\uFF0C\u82E5\u5177\u6709cache\uFF0CDocker\u6703re-use\u4E2D\u9593images\uFF0C\u4EE5\u52A0\u5FEB\u89E3\u6790\u901F\u5EA6\uFF0C\u5728console output\u4E2D\u53EF\u4EE5</p><p>\u770B\u5230<code>Using cache</code>\u7684\u63D0\u793A\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> build <span class="token builtin class-name">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><em><strong>\u6CE8\u610F!! \u52FF\u5C07path\u8A2D\u5B9A\u70BA / \uFF0C\u8A2D\u70BA / \u6703\u8996\u70BA\u60A8\u8981build \u6574\u500Bhard drive\u7684 \u6839\u76EE\u9304</strong></em></p><p><code>-f</code> \u6307\u5B9A\u69CB\u5EFA\u7684Dockerfile \u4F86\u6E90</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> build -f /path/to/a/Dockerfile
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="\u7DE8\u8F2F\u683C\u5F0F" tabindex="-1"><a class="header-anchor" href="#\u7DE8\u8F2F\u683C\u5F0F" aria-hidden="true">#</a> \u7DE8\u8F2F\u683C\u5F0F</h2><p><code>INSTRUCTION arguments</code></p><p><em><strong>INSTRUCTION\u4E26\u975E case-sensitive</strong></em></p><p>\u7FD2\u6163\u4E0A\u4F7F\u7528\u5927\u5BEB\uFF0C\u65B9\u4FBF\u95B1\u8B80\u8207arguments\u505A\u5340\u5225\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>RUN <span class="token builtin class-name">echo</span> <span class="token string">&#39;Test some cool things&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><em><strong>\u8A3B\u89E3\u7B26\u865F #</strong></em></p><p>Docker \u8996 <code>#</code> \u5F8C\u9762\u7684\u5167\u5BB9\u70BA\u8A3B\u89E3</p><p><em><strong>\u8DF3\u812B\u5B57\u5143</strong></em></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># escape=\\ (backslash)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>OR</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># escape=\` (backtick)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Docker \u4F7F\u7528 <code>\\</code> \u6216 <code>backtick</code> \u4F5C\u70BA\u8DF3\u812B\u7B26\u865F\uFF0C\u4F46\u7576\u5728windows\u4F5C\u696D\u7CFB\u7D71\u4E0B\u6642\uFF0C\u4F7F\u7528 \\ \u53EF\u80FD\u9020\u6210\u8DEF\u5F91\u89E3\u6790\u932F\u8AA4\uFF0C</p><p>\u6B64\u6642\u53EF\u4F7F\u7528escape\u7684parse directive\u6307\u5B9A\u4F7F\u7528 <code>backtick</code> \u4F5C\u70BA\u8DF3\u812B\u7B26\u865F\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># escape=\`</span>

FROM microsoft/nanoserver
COPY testfile.txt c:<span class="token punctuation">\\</span>
RUN <span class="token function">dir</span> c:<span class="token punctuation">\\</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="dockerignore-\u6A94\u6848" tabindex="-1"><a class="header-anchor" href="#dockerignore-\u6A94\u6848" aria-hidden="true">#</a> .dockerignore \u6A94\u6848</h2><p>\u5728docker CLI \u5C07context\u5167\u5BB9\u9001\u7D66docker daemon\u89E3\u6790\u524D\uFF0C\u5B83\u6703\u5148\u5728\u6839\u76EE\u9304\u67E5\u627E</p><p>\u6A94\u540D\u70BA <code>.dockerignore</code> \u7684\u6A94\u6848\uFF0C\u82E5\u6B64\u6A94\u6848\u5B58\u5728\uFF0CCLI\u6703\u81EA\u52D5\u5254\u9664\u5339\u914D\u5230\u5167\u90E8\u76F8\u95DC\u7684\u6A94\u6848</p><p>\u53EF\u907F\u514D\u4E0D\u5FC5\u8981\u7684\u6A94\u6848\u50B3\u8F38\u6216\u8F03\u654F\u611F\u7684\u8CC7\u6599\u6D41\u51FA\uFF0C\u7576\u4F7F\u7528 COPY \u6216 ADD \u6307\u4EE4\u6642\u3002</p><p>\u7BC4\u4F8B\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># comment</span>
*/temp*
*/*/temp*
temp?
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>*/temp*</code> \u5728\u7B2C\u4E00\u5C64\u8DEF\u5F91\u4E0B\uFF0C\u5254\u9664\u6A94\u540D\u6216\u8DEF\u5F91\u958B\u982D\u70BA temp \u7684\u8CC7\u6599</p><p><code>*/*/temp*</code> \u5728\u7B2C\u4E8C\u5C64\u8DEF\u5F91\u4E0B\uFF0C\u5254\u9664\u6A94\u540D\u6216\u8DEF\u5F91\u958B\u982D\u70BA temp \u7684\u8CC7\u6599</p><p><code>temp?</code> \u5254\u9664\u6839\u76EE\u9304\u4E0B\uFF0C\u6A94\u540D\u958B\u982D\u70BA temp \u7684\u8CC7\u6599</p><p>\u5339\u914D\u6A5F\u5236\u4F7F\u7528 Go&#39;s filepath.Match \u7684\u898F\u5247\u3002</p><p><em><strong>! \u7279\u4F8B\u884C\u70BA</strong></em></p><p>(\u5F85\u88DC)</p><h2 id="\u5E38\u898B-instruction" tabindex="-1"><a class="header-anchor" href="#\u5E38\u898B-instruction" aria-hidden="true">#</a> \u5E38\u898B INSTRUCTION</h2><p><em><strong>FROM</strong></em></p><p>\u8A2D\u7F6E\u69CB\u5EFA\u7684Base Image\uFF0C\u4E00\u500B valid \u7684 Dockerfile \u4E2D\uFF0C\u5FC5\u9808\u7531 FROM \u8D77\u982D\u64B0\u5BEB\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>FROM <span class="token operator">&lt;</span>image<span class="token operator">&gt;</span><span class="token punctuation">[</span>:<span class="token operator">&lt;</span>tag<span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>AS <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>ARG</code> \u53C3\u6578\u6307\u4EE4\u662F\u552F\u4E00\u53EF\u4EE5\u512A\u65BC <code>FROM</code> \u6307\u4EE4\u7684\u3002</p><p><code>FROM</code> \u6307\u4EE4\u53EF\u4EE5\u5728\u4E00\u500B Dockerfile \u4E2D\u51FA\u73FE\u6578\u6B21\uFF0C\u7528\u4EE5\u5EFA\u7ACB\u591A\u500Bimages\uFF0C</p><p>\u6BCF\u6B21\u547C\u53EB<code>FROM</code>\u6307\u4EE4\u90FD\u6703\u5C07\u4E0A\u4E00\u500B\u6307\u4EE4\u6240\u69CB\u5EFA\u7684\u72C0\u614B\u90FD\u6E05\u9664\u3002</p><p>\u6BCF\u6B21\u4F7F\u7528 <code>FROM</code> \u6642\uFF0C\u90FD\u53EF\u4EE5\u5728\u5176\u5F8C\u52A0\u4E0A <code>As name</code>\uFF0C\u8A72 name \u53EF\u4EE5\u7528\u65BC\u4E4B\u5F8C\u7684 <code>FROM</code></p><p>\u6216 <code>COPY --from=&lt;name|index&gt;</code> \u547C\u53EB\u4F7F\u7528\u3002</p><p><em><strong>ARG</strong></em></p><p><code>FROM</code> \u6307\u4EE4\u652F\u63F4\u6240\u6709\u5728\u5176\u4E4B\u524D\u5B9A\u7FA9\u7684ARG \u53C3\u6578\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ARG  <span class="token assign-left variable">CODE_VERSION</span><span class="token operator">=</span>latest
FROM base:<span class="token variable">\${CODE_VERSION}</span>
CMD  /code/run-app

FROM extras:<span class="token variable">\${CODE_VERSION}</span>
CMD  /code/run-extras
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>ARG</code> \u6307\u4EE4\u5B9A\u7FA9\u7684\u53C3\u6578\uFF0C\u56E0\u70BA\u662F\u8207<code>FROM</code>\u6240\u69CB\u5EFA\u7684\u72C0\u614B\u5206\u96E2\uFF0C\u6545\u7121\u6CD5\u518D\u7528\u65BC<code>FROM</code>\u6307\u4EE4\u5F8C\uFF0C</p><p>\u82E5\u9700\u8981\u518D\u6B21\u4F7F\u7528\u76F8\u540C\u53C3\u6578\u503C\u6642\uFF0C\u53EF\u7C21\u55AE\u518D\u65BC\u4F7F\u7528\u524D\u547C\u53EB <code>ARG</code> \u4E26\u7701\u7565 value</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ARG <span class="token assign-left variable">VERSION</span><span class="token operator">=</span>latest
FROM busybox:<span class="token variable">$VERSION</span>
ARG VERSION
RUN <span class="token builtin class-name">echo</span> <span class="token variable">$VERSION</span> <span class="token operator">&gt;</span> image_version
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em><strong>RUN</strong></em></p><p><code>RUN</code> \u6307\u4EE4\u6709\u5169\u7A2E\u683C\u5F0F\uFF1A</p><ol><li><p><code>RUN &lt;command&gt;</code> shellform\uFF0C\u6307\u4EE4\u57F7\u884C\u5728shell\uFF0C\u9810\u8A2D\u4F7F\u7528 <code>/bin/sh -c</code> on Linux \u53CA <code>bash /S /C</code> on Windows</p></li><li><p><code>RUN [&quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot;]</code> exec form</p></li></ol><p>RUN \u6307\u4EE4\u6703\u57F7\u884C\u4EFB\u4F55\u547D\u4EE4\u5728\u76EE\u524Dimage\u7684\u6700\u4E0A\u5C64\uFF0C\u4E26\u9001\u51FA\u7D50\u679C\uFF0C\u88AB\u9001\u51FA\u7684image\u7D50\u679C\u6703\u7E7C\u7E8C\u4F7F\u7528\u65BC\u5F8C\u7E8C\u7684Dockerfile\u4E2D\u3002</p><p>exec form\u53EF\u907F\u514Dshell\u7684\u6539\u5BEB\uFF0C\u6703\u7528 base image \u4F86 RUN commands\u3002</p><p>\u53EF\u7528 \\ \u5728shellform\u4E2D\u63DB\u884C\u8F38\u5165</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>RUN /bin/bash -c <span class="token string">&#39;source $HOME/.bashrc; \\
echo $HOME&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>same as</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>RUN /bin/bash -c <span class="token string">&#39;source $HOME/.bashrc; echo $HOME&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u82E5\u5E0C\u671B\u4F7F\u7528\u5225\u7684shell\uFF0C\u53EF\u4F7F\u7528 execform \u6307\u5B9A\u9700\u8981\u7684shell</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>RUN <span class="token punctuation">[</span><span class="token string">&quot;/bin/bash&quot;</span>, <span class="token string">&quot;-c&quot;</span>, <span class="token string">&quot;echo hello&quot;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u56E0exec form\u4F7F\u7528JSON\u683C\u5F0F\uFF0C\u6545\u52D9\u5FC5\u4F7F\u7528 <code>&quot;</code> \u96D9\u5F15\u865F</p><p><em><strong>CMD</strong></em></p><p>\u4E3B\u8981\u7528\u65BC\u63D0\u4F9Bcontainer \u7684default\u57F7\u884C</p><p>\u5171\u6709\u4E09\u7A2E\u683C\u5F0F\uFF1A</p><ol><li><p><code>CMD [&quot;executable&quot;,&quot;param1&quot;,&quot;param2&quot;]</code> (exec form, this is the preferred form)</p></li><li><p><code>CMD [&quot;param1&quot;,&quot;param2&quot;]</code> (as default parameters to ENTRYPOINT)</p></li><li><p><code>CMD command param1 param2</code> (shellform)</p></li></ol><p>\u4E00\u500BDockerfile\u4E2D\u53EA\u80FD\u6709\u4E00\u500B<code>CMD</code>\u6307\u4EE4\uFF0C\u8D85\u904E\u4E00\u500B\u6642\uFF0C\u53EA\u6703\u57F7\u884C\u6700\u5F8C\u51FA\u73FE\u7684\u4E00\u500B</p><p>\u7576\u4F7F\u7528<code>docker run</code>\u5176\u4ED6\u53C3\u6578\u6642\uFF0C\u5167\u90E8 CMD \u9810\u8A2D\u884C\u70BA\u5C07\u88AB\u66FF\u63DB\uFF0C\u8209\u4F8B\uFF1A(\u53D6IP)</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>FROM ubuntu:18.04
RUN <span class="token function">apt-get</span> update <span class="token punctuation">\\</span>
    <span class="token operator">&amp;&amp;</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y <span class="token function">curl</span> <span class="token punctuation">\\</span>
    <span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> -rf /var/lib/apt/lists/*
CMD <span class="token punctuation">[</span> <span class="token string">&quot;curl&quot;</span>, <span class="token string">&quot;-s&quot;</span>, <span class="token string">&quot;https://ip.cn&quot;</span> <span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5047\u5982\u6211\u5011\u4F7F\u7528 <code>docker build -t myip .</code> \u69CB\u5EFAimage\uFF0C\u4E26\u57F7\u884C</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run myip
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4F46\u82E5\u9700\u8981\u52A0\u4E0A\u53C3\u6578\u4F7F\u7528\u6642\uFF0C\u4F8B\u5982\u52A0\u4E0A <code>-i</code>\uFF0C\u52A0\u4E0A\u5F8C\u57F7\u884C</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run myip -i
docker: Error executable <span class="token function">file</span> not found
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u56E0\u70BA\u6839\u5728image\u540D\u5F8C\u9762\u7684\u662Fcommand\uFF0C\u904B\u884C\u6642\u6703\u66FF\u63DB<code>CMD</code>\u7684\u9ED8\u8A8D\u503C\uFF0C\u4E26\u975E\u6DFB\u52A0\u5728\u5176\u5F8C\u9762\u3002</p><p>\u82E5\u9808\u52A0\u4E0A<code>-i</code>\u9019\u53C3\u6578\uFF0C\u5FC5\u9808\u91CD\u65B0\u8F38\u5165\u6240\u6709command\uFF0C\u5F88\u9EBB\u7169\u7684\uFF0C\u6545\u6B64\u6642\u5C31\u53EF\u7528\u4E0B\u65B9<code>ENTRYPOINT</code>\u89E3\u6C7A\u6B64\u554F\u984C</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run myip <span class="token function">curl</span> -s https://ip.cn -i
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><em><strong>ENTRYPOINT</strong></em></p><p>\u683C\u5F0F\u548C RUN \u6307\u4EE4\u76F8\u540C\uFF0C\u76EE\u7684\u548CCMD\u76F8\u540C\uFF0C\u90FD\u662F\u5728\u6307\u5B9A\u5BB9\u5668\u555F\u52D5\u7A0B\u5E8F\u53CA\u53C3\u6578\u3002</p><p>\u5728\u904B\u884C\u6642\u4E5F\u53EF\u66FF\u4EE3\uFF0C\u9700\u4F7F\u7528<code>docker run --entrypoint</code>\u4F86\u6307\u5B9A\u3002</p><p>\u5EF6\u7E8C\u4E0A\u65B9<code>CMD</code>\u7684\u7BC4\u4F8B\uFF0C\u4E26\u4FEE\u6539\u70BA</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>FROM ubuntu:18.04
RUN <span class="token function">apt-get</span> update <span class="token punctuation">\\</span>
    <span class="token operator">&amp;&amp;</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y <span class="token function">curl</span> <span class="token punctuation">\\</span>
    <span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> -rf /var/lib/apt/lists/*
ENTRYPOINT <span class="token punctuation">[</span> <span class="token string">&quot;curl&quot;</span>, <span class="token string">&quot;-s&quot;</span>, <span class="token string">&quot;https://ip.cn&quot;</span> <span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u518D\u6B21\u5617\u8A66\u5C31\u6210\u529F\u4E86\uFF0C\u9019\u662F\u56E0\u70BA\u7576\u6307\u5B9A<code>ENTRYPOINT</code>\u5F8C\uFF0C<code>CMD</code>\u5C31\u4E0D\u518D\u662F\u76F4\u63A5\u904B\u884C\uFF0C</p><p>\u800C\u662F\u5C07\u5167\u5BB9\u50B3\u7D66<code>ENTRYPOINT</code>\u3002</p><p><em><strong>LABEL</strong></em></p><p>\u70BAimage\u8A18\u8F09\u76F8\u95DCmetadata</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>LABEL <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">&quot;1.0&quot;</span>
LABEL <span class="token assign-left variable">description</span><span class="token operator">=</span><span class="token string">&quot;This text cool&quot;</span>
LABEL <span class="token assign-left variable">maintainer</span><span class="token operator">=</span><span class="token string">&quot;johnnywang@home.org.com&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EF\u7528 <code>docker inspect</code> \u67E5\u770B</p><p><em><strong>EXPOSE</strong></em></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>EXPOSE <span class="token operator">&lt;</span>port<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>port<span class="token operator">&gt;</span>/<span class="token operator">&lt;</span>protocol<span class="token operator">&gt;</span><span class="token punctuation">..</span>.<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>EXPOSE</code> \u6307\u793ADocker Container\u5728runtime\u6642\uFF0C\u6240listen\u7684ports</p><p><code>EXPOSE</code> \u6307\u4EE4\u4E26\u6C92\u6709\u5BE6\u969B publish port\uFF0C\u50C5\u7528\u4EE5\u63D0\u4F9B\u4F7F\u7528\u8005\u61C9\u8A72publish\u5230\u54EA\u500Bport</p><p>\u9810\u8A2DEXPOSE \u4F7F\u7528TCP\uFF0C\u4E5F\u53EF\u6307\u5B9A\u70BAUDP</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>EXPOSE <span class="token number">80</span>/udp
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4F7F\u7528 <code>docker network</code> \u63D0\u4F9Bcontainer\u9593\u7684\u6E9D\u901A\uFF0C\u5373\u53EF\u4E0D\u5FC5\u8A2D\u5B9AEXPOSE\u53CApublish\u4F4D\u7F6E</p><p><em><strong>ADD, COPY</strong></em></p><p>\u683C\u5F0F\u548C\u6027\u8CEA\u57FA\u672C\u76F8\u540C\uFF0C\u4F46ADD\u5728COPY\u4E0A\u589E\u52A0\u4E00\u4E9B\u529F\u80FD\u3002\u6BD4\u5982<code>&lt;src&gt;</code>\u53EF\u4EE5\u662FURL\uFF0C</p><p>\u53E6\u5916ADD \u8907\u88FD\u7684\u6A94\u6848\u82E5\u70BA\u58D3\u7E2E\u6A94\uFF0C\u5C07\u6703\u81EA\u8463\u89E3\u58D3\u7E2E\u8655\u7406\u3002\u4F46\u82E5\u50C5\u9700\u8907\u88FD\u5C31\u597D\u6642\uFF0C\u5FC5\u9808\u4F7F\u7528COPY\u3002</p><p>\u5EFA\u8B70\u76E1\u91CF\u4F7F\u7528\u529F\u80FD\u8F03\u55AE\u7D14\u7684COPY\uFF0C\u56E0ADD\u5305\u542B\u8F03\u591A\u8907\u96DC\u529F\u80FD\uFF0C\u884C\u70BA\u4E0D\u4E00\u5B9A\u5F88\u6E05\u6670\uFF0C\u901A\u5E38\u53EA\u5728\u9700\u8981\u89E3\u58D3\u7E2E\u7684\u5834\u5408\u4F7F\u7528\u3002</p><p>\u6709\u5169\u7A2E\u683C\u5F0F\uFF1A</p><ol><li><p><code>ADD|COPY [--chown=&lt;user&gt;:&lt;group&gt;] &lt;src&gt;... &lt;dest&gt;</code></p></li><li><p><code>ADD|COPY [--chown=&lt;user&gt;:&lt;group&gt;] [&quot;&lt;src&gt;&quot;,... &quot;&lt;dest&gt;&quot;]</code> (\u7576path\u5305\u542B\u7A7A\u683C\u6642\uFF0C\u9700\u4F7F\u7528\u6B64\u683C\u5F0F)</p></li></ol><p>\u5F9E<code>&lt;src&gt;</code>\u8907\u88FD\u65B0\u6A94\u6848\u4E26\u65B0\u589E\u5230<code>&lt;dest&gt;</code>\uFF0C\u7576\u9700\u8981\u67E5\u627E\u6A94\u540D\u5305\u542B<code>[, ]</code>\u7B49\uFF0C\u5FC5\u9808\u4F7F\u7528Golang\u898F\u5247\uFF0C</p><p>\u5982\u4E0B\u7BC4\u4F8B\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ADD hom* /mydir/        <span class="token comment"># adds all files starting with &quot;hom&quot;</span>
ADD hom?.txt /mydir/    <span class="token comment"># ? is replaced with any single character, e.g., &quot;home.txt&quot;</span>

ADD arr<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token number">0</span><span class="token punctuation">]</span>.txt /mydir/    <span class="token comment"># copy a file named &quot;arr[0].txt&quot; to /mydir/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F7F\u7528\u6642\u9808\u9075\u5B88\u4EE5\u4E0B\u5E7E\u9EDE\uFF1A</p><ol><li><p><code>&lt;src&gt;</code>\u8DEF\u5F91\u5FC5\u9808\u5728context\u4E2D\uFF0C\u4E0D\u53EF\u4F7F\u7528\u5982 <code>ADD ../something /something</code></p></li><li><p>\u82E5<code>&lt;src&gt;</code>\u662F\u4E00\u500BURL\uFF0C\u4E14<code>&lt;dest&gt;</code>\u4E0D\u4EE5trailing slash\u7D50\u5C3E\uFF0C\u6A94\u6848\u5C07\u5F9Eurl\u4E0B\u8F09\u5F8C\u8907\u88FD\u9032<code>&lt;dest&gt;</code></p></li><li><p>\u82E5<code>&lt;src&gt;</code>\u662F\u4E00\u500BURL\uFF0C\u4F46<code>&lt;dest&gt;</code>\u4EE5trailing slash\u7D50\u5C3E\uFF0C\u6A94\u6848\u5C07\u5F9Eurl\u4E0B\u8F09\u5F8C\u8907\u88FD<code>&lt;dest&gt;/&lt;filename&gt;</code>\uFF0C</p><p>\u4F8B\u5982\uFF0C<code>ADD http://example.com/foobar /</code> \u6703\u5EFA\u7ACB <code>/foobar</code> \u6A94\u6848</p></li><li><p>\u82E5<code>&lt;src&gt;</code>\u662F\u4E00\u500B\u76EE\u9304\uFF0C\u5247\u8A72\u76EE\u9304\u4E0B\u7684\u6240\u6709\u5167\u5BB9\u90FD\u5C07\u88AB\u8907\u88FD\uFF0C\u5305\u62EC\u6A94\u6848\u7CFB\u7D71metadata\uFF0C\u76EE\u9304\u672C\u8EAB\u4E0D\u6703\u88AB\u8907\u88FD\uFF0C\u50C5\u5167\u5BB9</p></li></ol><p><em><strong>VOLUME</strong></em></p><p>VOLUME [&quot;/data&quot;]</p><p>(\u5F85\u88DC)</p><p><em><strong>WORKDIR</strong></em></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>WORKDIR /path/to/workdir
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u70BA\u6240\u6709<code>RUN, CMD, ENTRYPOINT, COPY, ADD</code> \u7B49\u6307\u4EE4\uFF0C\u8A2D\u7F6Eworking directory</p><p><code>WORKDIR</code> \u53EF\u4EE5\u5728\u4E00\u500BDockerfile\u5167\u4F7F\u7528\u591A\u6B21\uFF0C\u82E5\u4F7F\u7528\u76F8\u5C0D\u4F4D\u7F6E\u6642\uFF0C\u6703\u81EA\u52D5\u6BD4\u5C0D\u4E0A\u4E00\u500B<code>WORKDIR</code>\u7684\u4F4D\u7F6E</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>WORKDIR /a
WORKDIR b
WORKDIR c
RUN <span class="token builtin class-name">pwd</span>

<span class="token comment"># /a/b/c</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em><strong>ONBUILD</strong></em></p><p>(\u5F85\u88DC)</p>`,122),i=[c];function d(p,t){return s(),n("div",null,i)}var r=e(o,[["render",d],["__file","dockerfile-demo.html.vue"]]);export{r as default};
