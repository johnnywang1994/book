import{_ as n,o as s,c as a,f as p}from"./app-6ffe09b2.js";const t={},e=p(`<h1 id="gulp-學習筆記" tabindex="-1"><a class="header-anchor" href="#gulp-學習筆記" aria-hidden="true">#</a> Gulp 學習筆記</h1><p>本篇是在 2018 年左右撰寫，內容記錄一些學習 Gulp 的筆記</p><h2 id="gulp-介紹" tabindex="-1"><a class="header-anchor" href="#gulp-介紹" aria-hidden="true">#</a> Gulp 介紹</h2><p>gulp 與webpack不同，僅用以自定義生產自動化指令，並非打包系統，</p><p>使用輕便，但相對於webpack來說，不適合用於較為複雜之專案。</p><h2 id="gulp-基礎" tabindex="-1"><a class="header-anchor" href="#gulp-基礎" aria-hidden="true">#</a> Gulp 基礎</h2><p>使用時必須先全局安裝gulp-cli，並再local目錄內安裝gulp。</p><p>若電腦中已有安裝gulp，可以使用指令 gulp -v 測試，建議先移除舊版gulp 後</p><p>再行安裝新版本的gulp-cli。</p><p><em><strong>安裝 Gulp-Cli</strong></em></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">-g</span> gulp-cli
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><em><strong>安裝 Gulp</strong></em></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token function">npm</span> <span class="token function">install</span> --save-dev gulp
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><em><strong>建立 gulpfile.js</strong></em></p><p>gulp 指令讀取此檔案</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// gulpfile.js</span>
<span class="token keyword">const</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><em><strong>預設 default 指令</strong></em></p><p>建構基礎 default 指令模組，使用gulp default可呼叫指令執行</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&#39;default&#39;</span><span class="token punctuation">,</span> <span class="token parameter">done</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 資料來源</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Test OK!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 資料輸出</span>
  <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意：</p><p>上方出現的 done 為 gulp 的 task 預設callback函數，請在指令動作結束後呼叫。</p><p>避免造成 gulp 誤認為指令尚未結束，另也可以使用 return 顯性告訴 gulp 指令結束。</p><h2 id="pump-取代-pipe" tabindex="-1"><a class="header-anchor" href="#pump-取代-pipe" aria-hidden="true">#</a> pump 取代 pipe</h2><p>由於除錯不易的關係，pipe已被pump取代，請安裝 pump 使用。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token function">npm</span> <span class="token function">install</span> --save-dev pump
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><em><strong>使用方式</strong></em></p><p>以sass處理為例：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> concat <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-concat&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> autoprefixer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-autoprefixer&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cleanCss <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-clean-css&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sass <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-sass&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&#39;sass&#39;</span><span class="token punctuation">,</span> <span class="token parameter">cb</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">pump</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token comment">// 以數組存放所有指令</span>
    gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span>sassInput<span class="token punctuation">)</span><span class="token punctuation">,</span>
    sass<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;error&#39;</span><span class="token punctuation">,</span> sass<span class="token punctuation">.</span>logError<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">concat</span><span class="token punctuation">(</span>bundleName<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">autoprefixer</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">overrideBrowserslist</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;last 2 versions&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">cleanCss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span>sassOutput<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span> <span class="token comment">// 最後呼叫 cb 結束</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>此處的 cb 就是剛剛提到的 done，只是命名變數不同而已。</p><p>pump 使用方式比起原生pipe更為簡潔，並且只要指令中途出錯，就會完全停止執行並報錯提醒。</p><h2 id="gulp-watch-監聽文件" tabindex="-1"><a class="header-anchor" href="#gulp-watch-監聽文件" aria-hidden="true">#</a> gulp.watch 監聽文件</h2><p>gulp 內建可以使用檔案監聽功能，便於開發使用，使用如下：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sass <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-sass&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 先定義監聽變化後需要執行的指令</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&#39;sass&#39;</span><span class="token punctuation">,</span> <span class="token parameter">cb</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">pump</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span>sassInput<span class="token punctuation">)</span><span class="token punctuation">,</span>
    sass<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;error&#39;</span><span class="token punctuation">,</span> sass<span class="token punctuation">.</span>logError<span class="token punctuation">)</span><span class="token punctuation">,</span>
    gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span>sassOutput<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 定義目標對象監聽</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&#39;sass:watch&#39;</span><span class="token punctuation">,</span> <span class="token parameter">cb</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span>sassInput<span class="token punctuation">,</span> gulp<span class="token punctuation">.</span><span class="token function">series</span><span class="token punctuation">(</span><span class="token string">&#39;sass&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意：</p><ol><li><p>監聽屬性是放在task裡面使用，跟gulp.src, gulp.dest一樣位置</p></li><li><p>watch的第一個參數是監聽的對象，第二個參數請使用 gulp.series(a, b, c) 的方式，</p><p>將欲觸發的指令放入其中。</p></li><li><p>\bwatch 在執行當下，並不會先自動執行一次指令，如果需要在執行 watch 時，先執行一次時，</p><p>請在外部task處事先調用如下：</p></li></ol><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">&#39;sass:watch&#39;</span><span class="token punctuation">,</span> gulp<span class="token punctuation">.</span><span class="token function">series</span><span class="token punctuation">(</span><span class="token string">&#39;sass&#39;</span><span class="token punctuation">,</span> <span class="token parameter">cb</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span>sassInput<span class="token punctuation">,</span> gulp<span class="token punctuation">.</span><span class="token function">series</span><span class="token punctuation">(</span><span class="token string">&#39;sass&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>將原來task函數的第二個參數換成 gulp.series()，並以此形式將所有指令串接起來執行。
</code></pre><h2 id="文件匹配範例" tabindex="-1"><a class="header-anchor" href="#文件匹配範例" aria-hidden="true">#</a> 文件匹配範例</h2><p>匹配單一 sass 檔。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token string">&#39;./src/sass/index.sass&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>匹配單個資料夾下的 sass 檔，不包含其子目錄。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token string">&#39;./src/sass/*.sass&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>不匹配 _ 下劃號開頭的檔案，在開頭使用 ! 。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">&#39;./src/views/*.pug&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&#39;!./src/views/_*.pug&#39;</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>匹配所有 views 目錄下的 pug 檔。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token string">&#39;./src/views/**/*.pug&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="windows-系統-路徑匹配問題" tabindex="-1"><a class="header-anchor" href="#windows-系統-路徑匹配問題" aria-hidden="true">#</a> WINDOWS 系統 路徑匹配問題</h2><p>在WINDOWS系統中使用 nodejs 的 path 模組時，例如 path.resolve(__dirname, &#39;../&#39;)，</p><p>這種方式匯回傳為 C:\\Users\\XXX\\XXX ，導致 gulp 模組路徑無法正常運作，</p><p>有鑑於此請使用如下模組，將path經由 nodejs 提供的方法 path.sep</p><p>提出所有路徑為數組，再手動合成路徑正確可讀取之路徑：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span><span class="token function-variable function">crossPath</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span>sep<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,52),c=[e];function o(u,i){return s(),a("div",null,c)}const r=n(t,[["render",o],["__file","gulp-basic.html.vue"]]);export{r as default};
