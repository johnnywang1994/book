import{_ as t,r as p,o as e,c as o,a as s,d as a,e as c,f as l}from"./app-1a1ac012.js";const i={},u=a("h1",{id:"用-javascript-鎖定用戶調整畫面比例",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#用-javascript-鎖定用戶調整畫面比例","aria-hidden":"true"},"#"),c(" 用 JavaScript 鎖定用戶調整畫面比例")],-1),k=l(`<h5 id="updated-at-2021-04-20" tabindex="-1"><a class="header-anchor" href="#updated-at-2021-04-20" aria-hidden="true">#</a> updated at: 2021-04-20</h5><h6 id="tag-js-lock-resize-event" tabindex="-1"><a class="header-anchor" href="#tag-js-lock-resize-event" aria-hidden="true">#</a> tag <code>js</code>, <code>lock resize</code>, <code>event</code></h6><p>相信各位客官一定都遇過各種 PC 用戶亂調畫面比例導致網頁跑版的問題，或是根本不知道自己畫面有調整過比例的問題...，最近收到了需求就是希望能鎖定瀏覽器中的這個<code>調整畫面比例</code>功能。</p><p>以下是我自己想出來的解法，如有不週還請見諒～</p><h2 id="前言" tabindex="-1"><a class="header-anchor" href="#前言" aria-hidden="true">#</a> 前言</h2><p>要完成這個需求前，我們要先確認有哪些動作可以調整瀏覽器畫面，再針對各種動作進行阻擋。</p><p>主要分為兩種方式滾動:</p><ol><li><code>Ctrl + &quot;+&quot; or &quot;-&quot;</code>, <code>Command + &quot;+&quot; or &quot;-&quot;</code></li><li><code>Ctrl + &quot;滑鼠滾動&quot;</code></li></ol><h2 id="實作" tabindex="-1"><a class="header-anchor" href="#實作" aria-hidden="true">#</a> 實作</h2><h3 id="阻擋-ctrl-or" tabindex="-1"><a class="header-anchor" href="#阻擋-ctrl-or" aria-hidden="true">#</a> 阻擋 Ctrl + &quot;+&quot; or &quot;-&quot;</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">w<span class="token punctuation">,</span> d<span class="token punctuation">,</span> c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 確認 ctrl, command, plus, minus 等的 keycode</span>
  <span class="token keyword">const</span> ctrlKeycode <span class="token operator">=</span> <span class="token number">17</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> plusKeycode <span class="token operator">=</span> <span class="token number">187</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> minusKeycode <span class="token operator">=</span> <span class="token number">189</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> macCommendKeycode <span class="token operator">=</span> <span class="token number">91</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> isToolPressed <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

  <span class="token comment">// 添加 keydown 事件</span>
  w<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;keydown&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> keyCode <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
    <span class="token comment">// 按下 ctrl or command 開啟判斷</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>ctrlKeycode<span class="token punctuation">,</span> macCommendKeycode<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>keyCode<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      isToolPressed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 開關開啟，且按下 +, -</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>isToolPressed <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span>macPlusKeycode<span class="token punctuation">,</span> macMinusKeycode<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>keyCode<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">preventResize</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// 添加 keyup 事件</span>
  w<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;keyup&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 若放開 ctrl or command 關閉判斷</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>ctrlKeycode<span class="token punctuation">,</span> macCommendKeycode<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>keyCode<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      isToolPressed <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// 阻擋預設 event action</span>
  <span class="token keyword">function</span> <span class="token function">preventResize</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    isToolPressed <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token function">callback</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> document<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;\b警告你別調整畫面比例！&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="阻擋-ctrl-滑鼠滾輪滾動" tabindex="-1"><a class="header-anchor" href="#阻擋-ctrl-滑鼠滾輪滾動" aria-hidden="true">#</a> 阻擋 Ctrl + 滑鼠滾輪滾動</h3><p>這裡一開始我使用 scroll 來阻擋，經測試後確認 scroll 只會在頁面發生滾動後才觸發，但按住 Ctrl 時，滾動不會發生，這裡必須使用一個叫 <code>mousewheel</code> 的事件進行處理，這個事件會在任何鼠標滾輪滾動時觸發。</p><p>我們修改一下上面</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">w<span class="token punctuation">,</span> d<span class="token punctuation">,</span> c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...前略</span>
  <span class="token comment">// 添加 mousewheel 事件</span>
  w<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousewheel&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isToolPressed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">preventResize</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">function</span> <span class="token function">preventResize</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> document<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;\b警告你別調整畫面比例！&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>到這邊會發現，為何在 windows 系統上似乎不起作用，經過嘗試確認後，似乎對 window, html, body 等外層不起作用，必須對內部元素監聽才行，利用事件冒泡的原理由下阻擋事件傳遞出去，假設你東西都包在一個叫 <code>#root</code> 的元素內。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">w<span class="token punctuation">,</span> d<span class="token punctuation">,</span> c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...前略</span>
  <span class="token comment">// 添加 mousewheel 事件掛在內部元素上</span>
  d<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;#root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousewheel&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isToolPressed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">preventResize</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">function</span> <span class="token function">preventResize</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> document<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;\b警告你別調整畫面比例！&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>以上就完成最基本的 PC 縮放鎖定拉～～</p><h2 id="結論" tabindex="-1"><a class="header-anchor" href="#結論" aria-hidden="true">#</a> 結論</h2><p>雖然阻止用戶調整畫面比例不是一個推薦的作法，最好的方法還是將 rwd 做到極致，而不是添加一些強制措施，另外這種做法也只能阻止用戶在你的網頁調整，他還是可以在其他頁面裡調整完再去你的頁面啊ＸＤＤ～～</p><p>好拉，主要是介紹一些實作功能的小技巧跟知識，實用度不是很高ＸＤ，我們下次見拉～</p>`,21);function d(r,v){const n=p("SocialBlock");return e(),o("div",null,[u,s(n,{hashtags:"javascript,layout"}),k,s(n,{hashtags:"javascript,layout"})])}const b=t(i,[["render",d],["__file","lock-page-resize.html.vue"]]);export{b as default};
