import{_ as a,c as n,d as s,o as i}from"./app-aytLpXyP.js";const l={};function c(o,e){return i(),n("div",null,e[0]||(e[0]=[s(`<h1 id="server-與-network-優化" tabindex="-1"><a class="header-anchor" href="#server-與-network-優化"><span>Server 與 Network 優化</span></a></h1><h2 id="cdn-優化" tabindex="-1"><a class="header-anchor" href="#cdn-優化"><span>CDN 優化</span></a></h2><ul><li>提升網站資源穩定度、安全性、速度</li></ul><h3 id="cdn-cache" tabindex="-1"><a class="header-anchor" href="#cdn-cache"><span>CDN cache</span></a></h3><ul><li>三級緩存：Browser local cache、CDN Edge node cache、CDN source site cache</li><li>緩存時間：過短則頻繁訪問源檔案，導致負載訪問慢，過長則文件更新慢，本地文件無法及時更新，需綜合業務內容考慮</li><li>不同靜態資源類型緩存時間： <ul><li>HTML: 3min</li><li>JS/CSS: 10min, 1day, 30day</li></ul></li></ul><div class="language-nginx line-numbers-mode" data-highlighter="prismjs" data-ext="nginx"><pre><code class="language-nginx"><span class="line"><span class="token directive"><span class="token keyword">http</span></span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">80</span></span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">server_name</span> 123.com</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token directive"><span class="token keyword">location</span> ~* \\.(jpg|jpeg|png|gif|bmp|png|webp)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token directive"><span class="token keyword">expires</span> <span class="token number">30d</span></span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="dns-域名優化" tabindex="-1"><a class="header-anchor" href="#dns-域名優化"><span>DNS 域名優化</span></a></h2><p>瀏覽器併發數限制，前端可分佈設置多個域名，比如</p><ul><li>用戶訪問：Java, PHP API</li><li>頁面樣式：HTML/CSS/JS</li><li>圖片：jpg, png, gif...</li></ul><h2 id="http-請求優化" tabindex="-1"><a class="header-anchor" href="#http-請求優化"><span>HTTP 請求優化</span></a></h2><ul><li>使用 CSS Sprite</li><li>image 使用 DataURL, Web Font</li><li>JS/CSS file 合併</li><li>API 合併</li><li>API cache</li><li>static assets cache(icon)</li></ul><h2 id="server-緩存" tabindex="-1"><a class="header-anchor" href="#server-緩存"><span>Server 緩存</span></a></h2><ul><li>Expires: <ul><li>在 response header 中帶入，格式為日期、時間，表在此時間後 cache 過期</li><li>無效的日期，比如 0，代表過去的日期，即該資源已過期</li><li>如果在 <code>Cache-Control</code> header 設置 <code>max-age</code>, <code>s-max-age</code>，則 Expires 將被忽略</li><li><code>Expires: Tue, 17 Dec 2019 07:01:44 GMT</code></li></ul></li><li>Cache-Control: <ul><li>單向，request 中的指令，不一定被包含在 response 中</li><li><code>Cache-Control: max-age=&lt;seconds&gt;</code> 設定緩存最大週期，超過則過期，與 Expires 的絕對時間不同，此為<code>相對於請求的時間</code></li></ul></li><li>Etag: <ul><li>是 <code>HTTP 資源特定版本的標示符</code>，讓 cache 更高效、節省帶寬，若內容不變，則 server 不需要發送完整 response，若資源改變，Etag 可避免變動的資源更新互相覆蓋</li><li>若給定 URL 的資源變動，一定要生成新的 Etag 值，類似於指紋，也可能被某些 Server 用於跟蹤，比較 Etag 可快速確定資源是否改變，但也可能被跟蹤 Server 永久存留</li><li><code>Etag: 5c6cc12-1d45</code></li></ul></li><li>Last-Modified: <ul><li>包含 source server 認定資源的最後修改日期、時間，用來判斷接收到的、緩存的資源是否一致，因精確度比 ETag 低，主要作為備用手段</li><li><code>Last-Modified: Web, 20 Feb 2019 03:40:02 GMT</code></li></ul></li><li>Date: <ul><li>包含 message 的創建日期、時間</li><li><code>Date: Web, 20 Feb 2019 03:40:02 GMT</code></li></ul></li><li>Status: <ul><li>HTTP response 狀態碼，指示特定請求是否成功完成，主要分為 5類： <ul><li>訊息：<code>100-199</code></li><li>成功：<code>200-299</code></li><li>重導向：<code>300-399</code></li><li>Client端錯誤：<code>400-499</code></li><li>Server端錯誤：<code>500-599</code></li></ul></li></ul></li></ul><h2 id="gzip-壓縮" tabindex="-1"><a class="header-anchor" href="#gzip-壓縮"><span>gzip 壓縮</span></a></h2><ul><li>文本壓縮 HTML/CSS/JS</li><li>非文本不壓縮 Image</li><li>Nginx(<code>gzip on</code>)</li><li>Apache(<code>AddOutputFilterByType</code>)</li><li>透過 response header <code>Content-Encoding: gzip</code>，代表 server 已開啟 gzip</li></ul><h2 id="http2-優化" tabindex="-1"><a class="header-anchor" href="#http2-優化"><span>HTTP2 優化</span></a></h2><ul><li><a href="https://www.youtube.com/watch?v=zoCcPJc54r8" target="_blank" rel="noopener noreferrer">Link</a></li><li>二進制傳輸資料，<code>保護網站安全</code></li><li>允許透過一個 http2 連結發起多個請求，<code>降低 server 壓力</code></li><li>Header 壓縮，傳輸體積小，<code>提升網站訪問速度</code></li><li>server 推送，server 可更快把資源推送給客戶端</li></ul><h3 id="nginx-啟用-http2" tabindex="-1"><a class="header-anchor" href="#nginx-啟用-http2"><span>Nginx 啟用 HTTP2</span></a></h3><ul><li>升級 openssl version</li><li>重新編譯 <ul><li>cd nginx-xxxx</li><li>./configure --with-http_ssl_module --with-http_v2_module</li><li>make &amp;&amp; make install</li></ul></li><li>驗證：瀏覽器下查看有沒有小綠鎖</li><li>瀏覽器請求：<code>protocol h2</code></li><li>nginx config <code>listen 443 ssl http2</code></li></ul>`,19)]))}const r=a(l,[["render",c]]),d=JSON.parse('{"path":"/articles/memo/fe-performance/network.html","title":"Server 與 Network 優化","lang":"zh-TW","frontmatter":{},"git":{"updatedTime":1748788505000,"contributors":[{"name":"johnnywang","username":"johnnywang","email":"johnnywang@test.com","commits":1,"url":"https://github.com/johnnywang"},{"name":"Lindy Liao","username":"","email":"meiliao1207@gmail.com","commits":1}],"changelog":[{"hash":"f01bfa128b4d33fbeddb8abb1697b5391b273d28","time":1748788505000,"email":"meiliao1207@gmail.com","author":"Lindy Liao","message":"UPD"},{"hash":"fe140b6c58ff95658ca7b3af6c30d3fa536cd537","time":1721122771000,"email":"johnnywang@test.com","author":"johnnywang","message":"UPD: add fe performance"}]},"filePathRelative":"articles/memo/fe-performance/network.md"}');export{r as comp,d as data};
