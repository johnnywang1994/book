import{_ as c,r as p,o as i,c as l,a as s,d as n,e as a,f as e}from"./app.31edfc4c.js";const u={},r=n("h1",{id:"observer-pattern",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#observer-pattern","aria-hidden":"true"},"#"),a(" Observer Pattern")],-1),k=e(`<h2 id="\u524D\u8A00" tabindex="-1"><a class="header-anchor" href="#\u524D\u8A00" aria-hidden="true">#</a> \u524D\u8A00</h2><p>\u5927\u5BB6\u597D\uFF0C\u6211\u662F Johnny\uFF0C\u4ECA\u5929\u8981\u7D00\u9304\u5206\u4EAB\u7684\u662F Patterns \u7B46\u8A18\u7CFB\u5217\u7684 <code>Observer Pattern</code></p><h2 id="\u4ECB\u7D39" tabindex="-1"><a class="header-anchor" href="#\u4ECB\u7D39" aria-hidden="true">#</a> \u4ECB\u7D39</h2><p>Observer \u4F7F\u6211\u5011\u80FD\u5920\u5C0D\u7269\u4EF6\u9032\u884C\u8A02\u95B1\uFF0C\u7576 observable \u76EE\u6A19\u88AB\u8A02\u95B1\u7269\u4EF6\u51FA\u73FE\u4EFB\u4F55\u4E8B\u4EF6\uFF0C\u80FD\u5920\u5C0D\u5176\u5C0D\u61C9\u7684\u6240\u6709\u8A02\u95B1\u8005 observer \u50B3\u905E\u901A\u77E5\uFF0C\u4E00\u500B\u7D93\u5178\u7684\u6848\u4F8B\u5C31\u662F\uFF0C\u7576\u4F60\u8A02\u95B1\u7684\u7DB2\u7D05\u4ECA\u5929\u767C\u5E03\u4E86\u6700\u65B0\u5F71\u7247\uFF0C\u5176\u6240\u6709\u8A02\u95B1\u8005\u90FD\u5C07\u99AC\u4E0A\u6536\u5230\u901A\u77E5\u8A0A\u606F</p><p>\u4E00\u500B Observable \u7269\u4EF6\u901A\u5E38\u5305\u542B\u4EE5\u4E0B 3\u500B\u91CD\u8981\u90E8\u5206\uFF1A</p><ul><li><code>observers</code>: \u8A02\u95B1\u8005\u6E05\u55AE</li><li><code>subscribe()</code>: \u8A02\u95B1</li><li><code>unsubscribe()</code>: \u53D6\u6D88\u8A02\u95B1</li><li><code>notify()</code>: \u901A\u77E5\u6240\u6709\u8A02\u95B1\u8005</li></ul><p>\u6839\u64DA\u4EE5\u4E0A\uFF0C\u6211\u5011\u4F86\u5BE6\u969B\u52D5\u624B\u8A66\u8A66</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Observable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">func</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token parameter">func</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">observer</span> <span class="token operator">=&gt;</span> observer <span class="token operator">!==</span> func<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">notify</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">observer</span> <span class="token operator">=&gt;</span> <span class="token function">observer</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u63A5\u8457\u5BE6\u969B\u4F7F\u7528\u770B\u770B\uFF0C\u6211\u5011\u4EE5 React \u4F5C\u70BA\u7BC4\u4F8B\uFF0C\u5B9A\u7FA9\u4E26\u8A02\u95B1\u5169\u500B\u51FD\u6578 logger, toastify\uFF0C\u9019\u6A23\u5F8C\u7E8C\u6211\u5011\u53EA\u9700\u8981\u901A\u77E5 observable \u6642\u5C31\u6703\u81EA\u52D5\u901A\u77E5\u9019\u5169\u500B\u51FD\u6578\u57F7\u884C</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> Toast<span class="token punctuation">,</span> <span class="token punctuation">{</span> toast <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/components/Toast&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> toastObservable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Observable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">logger</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">toastify</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">toast</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

observable<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>logger<span class="token punctuation">)</span><span class="token punctuation">;</span>
observable<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>toastify<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    observable<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token string">&quot;User clicked button!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">handleToggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    observable<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token string">&quot;User toggled switch!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;App&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Button<span class="token operator">&gt;</span>Click me<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>FormControlLabel control<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">&lt;</span>Switch <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>ToastContainer <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="rxjs" tabindex="-1"><a class="header-anchor" href="#rxjs" aria-hidden="true">#</a> Rxjs</h2><p>\u4E00\u500B Observer Pattern \u7684\u7D93\u5178\u6848\u4F8B\u5C31\u662F\u6709\u540D\u7684 <code>Rxjs</code> \u5957\u4EF6\uFF0C\u5728 Rxjs \u4E2D\u7684 <code>Observable</code> \u5C31\u662F\u904B\u7528\u9019\u7A2E\u6A21\u5F0F\u4F86\u5BE6\u4F5C\uFF0C\u7576\u7136 Rxjs \u4E0D\u53EA\u9019\u6A23\uFF0C\u9084\u63D0\u4F9B\u66F4\u591A\u65B9\u4FBF\u7684\u65B9\u6CD5\u8207\u5BE6\u4F5C\uFF0C\u5E95\u4E0B\u662F\u4E00\u500B\u7D93\u5178\u7684\u7BC4\u4F8B</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;rxjs&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> observable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Observable</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">subscriber</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  subscriber<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  subscriber<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  subscriber<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    subscriber<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    subscriber<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;just before subscribe&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
observable<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;got value &#39;</span> <span class="token operator">+</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">error</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;something wrong occurred: &#39;</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;done&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;just after subscribe&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u9762\u9019\u6BB5\u5728\u57F7\u884C\u5F8C\u6703\u5F97\u5230\u9019\u6A23\u7684\u7D50\u679C\uFF0C\u5176\u4E2D\u7684 <code>subscriber</code> \u5C31\u662F\u6211\u5011\u7684\u8A02\u95B1\u5167\u5BB9\uFF0C\u6211\u5011\u53EF\u4EE5\u900F\u904E\u4ED6\u53D6\u5F97\u5404\u500B\u89C0\u5BDF\u8005\u7269\u4EF6</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>just before subscribe
got value 1
got value 2
got value 3
just after subscribe
got value 4
done
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,15),d={href:"https://rxjs.dev/",target:"_blank",rel:"noopener noreferrer"},v=e('<h2 id="\u512A\u7F3A\u9EDE" tabindex="-1"><a class="header-anchor" href="#\u512A\u7F3A\u9EDE" aria-hidden="true">#</a> \u512A\u7F3A\u9EDE</h2><h3 id="\u512A\u9EDE" tabindex="-1"><a class="header-anchor" href="#\u512A\u9EDE" aria-hidden="true">#</a> \u512A\u9EDE</h3><p>Observer Pattern \u53EF\u4EE5\u5F37\u5316 <code>\u95DC\u6CE8\u9EDE\u5206\u96E2</code>\u3001<code>\u55AE\u4E00\u8077\u8CAC\u539F\u5247</code>\uFF0C\u5176\u4E2D\u7684 observer objects \u89C0\u5BDF\u8005\u5C0D\u8C61\u4E26\u4E0D\u6703\u5F37\u7D81\u5B9A\u5728 observable \u7269\u4EF6\u4E0A\uFF0C\u80FD\u5920\u88AB\u66F4\u5927\u7A0B\u5EA6\u7684\u91CD\u8907\u4F7F\u7528\uFF0C\u85C9\u6B64\u63D0\u9AD8\u7A0B\u5F0F\u78BC\u7684\u53EF\u8B80\u6027\u3001\u6A21\u7D44\u5316\uFF0C\u5176\u4E2D observable \u7269\u4EF6\u8CA0\u8CAC\u76E3\u807D\u4E8B\u4EF6\uFF0C\u800C observer \u5247\u53EA\u9700\u8981\u95DC\u6CE8\u5728\u62FF\u5230\u8CC7\u6599\u5F8C\u7E8C\u505A\u4E8B</p><h3 id="\u7F3A\u9EDE" tabindex="-1"><a class="header-anchor" href="#\u7F3A\u9EDE" aria-hidden="true">#</a> \u7F3A\u9EDE</h3><p>\u7576 observer \u8D8A\u4F86\u8D8A\u5927\u8907\u96DC\u3001observable \u8A02\u95B1\u7684\u5C0D\u8C61\u8D8A\u4F86\u8D8A\u591A\u6642\uFF0C\u5728\u9032\u884C notify \u901A\u77E5\u6240\u6709\u8A02\u95B1\u7269\u4EF6\u6642\u53EF\u80FD\u6703\u767C\u751F\u6548\u80FD\u554F\u984C</p><p>\u611F\u8B1D\u6536\u770B\uFF0C\u4E0B\u7BC7\u898B\u62C9\uFF5E</p>',6);function b(m,f){const t=p("SocialBlock"),o=p("ExternalLinkIcon");return i(),l("div",null,[r,s(t,{hashtags:"design,pattern,observer,rxjs"}),k,n("p",null,[a("\u5C0D\u8A73\u7D30\u7528\u6CD5\u6709\u8208\u8DA3\u7684\u4EBA\uFF0C\u53EF\u4EE5\u53C3\u8003"),n("a",d,[a("Rxjs \u5B98\u65B9\u6587\u4EF6"),s(o)])]),v,s(t,{hashtags:"design,pattern,observer,rxjs"})])}const g=c(u,[["render",b],["__file","observer.html.vue"]]);export{g as default};
