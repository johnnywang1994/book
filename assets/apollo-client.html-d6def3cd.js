import{_ as p,r as o,o as l,c,d as n,e as s,a as e,f as t}from"./app-6147e6e2.js";const i={},r=n("h1",{id:"apollo-client-å­¸ç¿’ä½¿ç”¨ç­†è¨˜",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#apollo-client-å­¸ç¿’ä½¿ç”¨ç­†è¨˜","aria-hidden":"true"},"#"),s(" Apollo Client å­¸ç¿’ä½¿ç”¨ç­†è¨˜")],-1),u=n("p",null,"æœ¬ç¯‡æ˜¯å­¸ç¿’åŸºç¤ Apollo Client æ™‚çš„éƒ¨åˆ†ç­†è¨˜ï¼ŒåŒæ¨£åƒ…è¨˜éŒ„ç‰¹å®šæˆ‘è¦ºå¾—å¾ˆé‡è¦çš„éƒ¨åˆ†ï¼Œæœƒæ ¹æ“šæˆ‘å¯¦éš›ä½¿ç”¨ç‹€æ³æŒçºŒå¢è£œå…§å®¹ï¼Œä¸æœƒæŠŠæ‰€æœ‰åŸºç¤å…§å®¹éƒ½ç´€éŒ„åœ¨é€™",-1),d={href:"https://www.apollographql.com/docs/react/",target:"_blank",rel:"noopener noreferrer"},k=n("h2",{id:"fetch-policy",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#fetch-policy","aria-hidden":"true"},"#"),s(" Fetch Policy")],-1),v={href:"https://www.apollographql.com/docs/react/data/queries/#supported-fetch-policies",target:"_blank",rel:"noopener noreferrer"},m=n("code",null,"cache-first",-1),h=n("code",null,"nextFetchPolicy",-1),b=t(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> loading<span class="token punctuation">,</span> error<span class="token punctuation">,</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useQuery</span><span class="token punctuation">(</span><span class="token constant">GET_DOGS</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">fetchPolicy</span><span class="token operator">:</span> <span class="token string">&#39;network-only&#39;</span><span class="token punctuation">,</span> <span class="token comment">// Used for first execution</span>
  <span class="token literal-property property">nextFetchPolicy</span><span class="token operator">:</span> <span class="token string">&#39;cache-first&#39;</span><span class="token punctuation">,</span> <span class="token comment">// Used for subsequent executions</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),g={href:"https://www.apollographql.com/docs/react/data/queries#nextfetchpolicy",target:"_blank",rel:"noopener noreferrer"},y=n("h2",{id:"update-local-data",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#update-local-data","aria-hidden":"true"},"#"),s(" Update Local Data")],-1),f={href:"https://www.apollographql.com/docs/react/data/mutations#updating-local-data",target:"_blank",rel:"noopener noreferrer"},_=t(`<h3 id="refetching-query" tabindex="-1"><a class="header-anchor" href="#refetching-query" aria-hidden="true">#</a> refetching query</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// Refetches two queries after mutation completes</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>addTodo<span class="token punctuation">,</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> loading<span class="token punctuation">,</span> error <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useMutation</span><span class="token punctuation">(</span><span class="token constant">ADD_TODO</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">refetchQueries</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token literal-property property">query</span><span class="token operator">:</span> <span class="token constant">GET_POST</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// DocumentNode object parsed with gql</span>
    <span class="token string">&#39;GetComments&#39;</span> <span class="token comment">// Query name</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="updating-cache-directly" tabindex="-1"><a class="header-anchor" href="#updating-cache-directly" aria-hidden="true">#</a> updating cache directly</h3><p>include the result from mutation response, <code>cache</code> object includes <code>readQuery/writeQuery</code>, <code>readFragment/writeFragment</code>, <code>modify</code>, and <code>evict</code> method</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>addTodo<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useMutation</span><span class="token punctuation">(</span><span class="token constant">ADD_TODO</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter">cache<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span> addTodo <span class="token punctuation">}</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cache<span class="token punctuation">.</span><span class="token function">modify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">fields</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function">todos</span><span class="token punctuation">(</span><span class="token parameter">existingTodos <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> newTodoRef <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">writeFragment</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">data</span><span class="token operator">:</span> addTodo<span class="token punctuation">,</span>
            <span class="token literal-property property">fragment</span><span class="token operator">:</span> gql<span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">
              fragment NewTodo on Todo {
                id
                type
              }
            </span><span class="token template-punctuation string">\`</span></span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>existingTodos<span class="token punctuation">,</span> newTodoRef<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="fragments" tabindex="-1"><a class="header-anchor" href="#fragments" aria-hidden="true">#</a> Fragments</h2><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>fragment NameParts on Person <span class="token punctuation">{</span>
  title
  firstName
  middleName
  lastName
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="inline-fragments-with-unions-interfaces" tabindex="-1"><a class="header-anchor" href="#inline-fragments-with-unions-interfaces" aria-hidden="true">#</a> inline fragments with Unions Interfaces</h3><p>ç›¸é—œç­†è¨˜å·²è¨˜éŒ„åœ¨ <code>graphql/advance</code> å…§</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>query AllCharacters <span class="token punctuation">{</span>
  all_characters <span class="token punctuation">{</span>

    <span class="token operator">...</span> on Character <span class="token punctuation">{</span>
      name
    <span class="token punctuation">}</span>

    <span class="token operator">...</span> on Jedi <span class="token punctuation">{</span>
      side
    <span class="token punctuation">}</span>

    <span class="token operator">...</span> on Droid <span class="token punctuation">{</span>
      model
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="possibletypes" tabindex="-1"><a class="header-anchor" href="#possibletypes" aria-hidden="true">#</a> possibleTypes</h3>`,11),w={href:"https://www.apollographql.com/docs/react/data/fragments#defining-possibletypes-manually",target:"_blank",rel:"noopener noreferrer"},q=n("li",null,[n("p",null,"æ‰‹å‹•å®šç¾©")],-1),x=t(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">possibleTypes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">Character</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;Jedi&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Droid&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">Test</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;PassingTest&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FailingTest&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;SkippedTest&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">Snake</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;Viper&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Python&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),j={href:"https://www.apollographql.com/docs/react/data/fragments#generating-possibletypes-automatically",target:"_blank",rel:"noopener noreferrer"},T=n("h2",{id:"graphql-query-best-practices",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#graphql-query-best-practices","aria-hidden":"true"},"#"),s(" GraphQL query best practices")],-1),C={href:"https://www.apollographql.com/docs/react/data/operation-best-practices",target:"_blank",rel:"noopener noreferrer"},Q=n("li",null,[n("p",null,"Name all operations: å‘½åæ‰€æœ‰ query, mutation æ“ä½œ")],-1),F=n("li",null,[n("p",null,[s("Provide variable as arguments: æä¾›è®Šæ•¸ä½œç‚ºåƒæ•¸ï¼Œæ¨è–¦ä½¿ç”¨ "),n("code",null,"$input"),s(" åŒ…è£¹æ‰€æœ‰åƒæ•¸")])],-1),I={href:"https://www.apollographql.com/docs/intro/benefits/#graphql-provides-declarative-efficient-data-fetching",target:"_blank",rel:"noopener noreferrer"},L=n("li",null,[n("p",null,"Use fragments: ä½¿ç”¨ fragments å°è£ç›¸ä¼¼æ¬„ä½å­—æ®µï¼Œä½†é¿å…éåº¦æ¿«ç”¨")],-1),D=n("li",null,[n("p",null,"Query separately: åˆ†é–‹ query å…¨åŸŸè³‡æ–™åŠ user ç›¸é—œè³‡æ–™ï¼Œè®“ GraphQL èƒ½æœ‰æ•ˆé€²è¡Œç¨ç«‹ cache ä½œæ¥­ï¼Œæå‡æ•ˆèƒ½ï¼ˆåƒè¬åˆ¥åœ¨åŒä¸€å€‹ query è£¡æ‹¿ä¸€å †ä¸åŒ type çš„æ±è¥¿ï¼‰")],-1),P=n("li",null,[n("p",null,[s("Add "),n("code",null,"name"),s(", "),n("code",null,"version"),s(" in client: åœ¨ ApolloClient åˆå§‹åŒ–æ™‚æä¾› name, version æå‡åµéŒ¯çš„æ•ˆç‡")])],-1),A=t(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">uri</span><span class="token operator">:</span> <span class="token string">&#39;http://localhost:4000/graphql&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">cache</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;MarketingSite&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">version</span><span class="token operator">:</span> <span class="token string">&#39;1.2&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="cache" tabindex="-1"><a class="header-anchor" href="#cache" aria-hidden="true">#</a> Cache</h2>`,2),N={href:"https://www.apollographql.com/docs/react/caching/overview",target:"_blank",rel:"noopener noreferrer"},G=n("h3",{id:"typepolicies",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#typepolicies","aria-hidden":"true"},"#"),s(" typePolicies")],-1),S={href:"https://www.apollographql.com/docs/react/caching/cache-configuration#customizing-cache-ids",target:"_blank",rel:"noopener noreferrer"},V=t(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> makeVar <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@apollo/client&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> doneVar <span class="token operator">=</span> makeVar<span class="token operator">&lt;</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">typePolicies</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">Product</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// In an inventory management system, products might be identified</span>
      <span class="token comment">// by their UPC.</span>
      <span class="token literal-property property">keyFields</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;upc&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">Todo</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// custom behavior by field name</span>
      <span class="token comment">// eg. å¯ä»¥ç”¨å®¢è£½åŒ–çš„ cache æ©Ÿåˆ¶è£½ä½œ client only çš„æ¬„ä½ï¼Œä¸¦åœ¨ query æ™‚æ¨™è¨»ç²å–</span>
      <span class="token literal-property property">fields</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">isDone</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token function">read</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> <span class="token punctuation">{</span> readField <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> objectId <span class="token operator">=</span> <span class="token function">readField</span><span class="token punctuation">(</span><span class="token string">&#39;objectId&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> string<span class="token punctuation">;</span>
            <span class="token keyword">const</span> doneList <span class="token operator">=</span> <span class="token function">doneVar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">return</span> doneList<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>objectId<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),M={href:"https://www.apollographql.com/docs/react/local-state/managing-state-with-field-policies/",target:"_blank",rel:"noopener noreferrer"},R=t(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> todoItem <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">
  fragment TodoItem on Todo {
    objectId
    title
    content
    isDone @client
  }
</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="read-write-interaction" tabindex="-1"><a class="header-anchor" href="#read-write-interaction" aria-hidden="true">#</a> Read/Write Interaction</h3>`,2),O={href:"https://www.apollographql.com/docs/react/caching/cache-interaction",target:"_blank",rel:"noopener noreferrer"},U=t(`<h4 id="read-all-caches" tabindex="-1"><a class="header-anchor" href="#read-all-caches" aria-hidden="true">#</a> Read All Caches</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useApolloClient <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@apollo/client&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token function">useApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> serializedState <span class="token operator">=</span> client<span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>serializedState<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="read-write-query-cache" tabindex="-1"><a class="header-anchor" href="#read-write-query-cache" aria-hidden="true">#</a> Read/Write Query Cache</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// Fetch the cached to-do item with ID 5</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> todo <span class="token punctuation">}</span> <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">readQuery</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">query</span><span class="token operator">:</span> gql<span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">
    query ReadTodo($id: ID!) {
      todo(id: $id) {
        id
        text
        completed
      }
    }
  </span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
  <span class="token literal-property property">variables</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// Provide any required variables here.  Variables of mismatched types will return \`null\`.</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

client<span class="token punctuation">.</span><span class="token function">writeQuery</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">query</span><span class="token operator">:</span> gql<span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">
    query WriteTodo($id: Int!) {
      todo(id: $id) {
        id
        text
        completed
      }
    }</span><span class="token template-punctuation string">\`</span></span>
  <span class="token punctuation">,</span>
  <span class="token literal-property property">variables</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">5</span>
  <span class="token punctuation">}</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// Contains the data to write</span>
    <span class="token literal-property property">todo</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">__typename</span><span class="token operator">:</span> <span class="token string">&#39;Todo&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&#39;Buy grapes ğŸ‡&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">completed</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4),E=n("code",null,"ä¸è¦ç›´æ¥ä¿®æ”¹è¿”å›çš„å°è±¡",-1),$={href:"https://www.apollographql.com/docs/react/caching/cache-interaction#combining-reads-and-writes",target:"_blank",rel:"noopener noreferrer"},B=t(`<p>ç•¶ä½¿ç”¨ <code>writeQuery</code> æ™‚ï¼Œæ³¨æ„ä»¥ä¸‹æç¤ºï¼š</p><ul><li>ä»»ä½•ä½¿ç”¨ <code>writeQuery</code> å° cache è³‡æ–™çš„æ”¹å‹•ä¸æœƒåŒæ­¥åˆ° GraphQL serverï¼Œé‡æ–°æ•´ç†å¾Œå°±æœƒæ¶ˆå¤±</li><li>query çš„ shape ä¸éœ€è¦è·Ÿ GraphQL server çš„ schema ç›¸åŒï¼Œå¯ä»¥åŒ…å«ä¸åœ¨ schema ä¸­çš„æ¬„ä½</li></ul><h4 id="read-write-fragments" tabindex="-1"><a class="header-anchor" href="#read-write-fragments" aria-hidden="true">#</a> Read/Write Fragments</h4><ul><li>id: <code>&lt;__typename&gt;:&lt;id&gt;</code></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> todo <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">readFragment</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;Todo:5&#39;</span><span class="token punctuation">,</span> <span class="token comment">// The value of the to-do item&#39;s cache ID</span>
  <span class="token literal-property property">fragment</span><span class="token operator">:</span> gql<span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">
    fragment MyTodo on Todo {
      id
      text
      completed
    }
  </span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

client<span class="token punctuation">.</span><span class="token function">writeFragment</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;Todo:5&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">fragment</span><span class="token operator">:</span> gql<span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">
    fragment MyTodo on Todo {
      completed
    }
  </span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">completed</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="update-query-cache" tabindex="-1"><a class="header-anchor" href="#update-query-cache" aria-hidden="true">#</a> Update Query Cache</h4>`,6),W={href:"https://www.apollographql.com/docs/react/caching/cache-interaction#using-updatequery-and-updatefragment",target:"_blank",rel:"noopener noreferrer"},z=n("code",null,"updateQuery",-1),J=n("code",null,"updateFragment",-1),H=n("code",null,"read/write",-1),K=t(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> query <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">
  query MyTodoAppQuery {
    todos {
      id
      text
      completed
    }
  }
</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>

<span class="token comment">// Set all todos in the cache as completed</span>
cache<span class="token punctuation">.</span><span class="token function">updateQuery</span><span class="token punctuation">(</span><span class="token punctuation">{</span> query <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">todos</span><span class="token operator">:</span> data<span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">todo</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>todo<span class="token punctuation">,</span> <span class="token literal-property property">completed</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1);function X(Y,Z){const a=o("ExternalLinkIcon");return l(),c("div",null,[r,u,n("ul",null,[n("li",null,[n("a",d,[s("Apollo Client"),e(a)])])]),k,n("ul",null,[n("li",null,[n("a",v,[s("Supported fetch policies"),e(a)]),s(" é è¨­ Query ä½¿ç”¨çš„ cache æ”¿ç­–æ˜¯ "),m,s("ï¼Œç•¶è«‹æ±‚æ™‚æœƒå…ˆæª¢æŸ¥æœ¬åœ° cacheï¼Œå¦‚æœå­˜åœ¨å‰‡ç›´æ¥è¿”å›ï¼Œè€Œä¸é€²è¡Œ network requestï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ "),h,s(" è¨­å®šç¬¬äºŒæ¬¡å¾Œè«‹æ±‚çš„ cache æ”¿ç­–ï¼Œå¦‚ä¸‹ç¯„ä¾‹ç¸½æ˜¯åœ¨ç¬¬ä¸€æ¬¡æ™‚å¯¦éš›é€²è¡Œ network requestï¼Œä¸¦åœ¨ä¹‹å¾Œä»¥ cache è¿”å›ç‚ºä¸»")])]),b,n("p",null,[s("è©³ç´°ä½¿ç”¨å¯åƒè€ƒ"),n("a",g,[s("nextFetchPolicy"),e(a)])]),y,n("ul",null,[n("li",null,[n("a",f,[s("Link"),e(a)])])]),_,n("ul",null,[n("li",null,[n("p",null,[n("a",w,[s("Link"),e(a)])])]),q]),x,n("ul",null,[n("li",null,[n("a",j,[s("è‡ªå‹•ç”¢ç”Ÿ"),e(a)])])]),T,n("ul",null,[n("li",null,[n("p",null,[n("a",C,[s("Link"),e(a)])])]),Q,F,n("li",null,[n("p",null,[s("Get data only when/where you need: åªæ‹¿ä½ éœ€è¦ç”¨åˆ°çš„è³‡æ–™ï¼Œç™¼æ® GraphQL å„ªå‹¢-"),n("a",I,[s("declarative data fetching"),e(a)])])]),L,D,P]),A,n("ul",null,[n("li",null,[n("a",N,[s("Link"),e(a)])])]),G,n("ul",null,[n("li",null,[n("a",S,[s("Custom Cache id"),e(a)])])]),V,n("ul",null,[n("li",null,[s("query ç²å– client only æ¬„ä½ï¼Œè©³æƒ…å¯åƒè€ƒ "),n("a",M,[s("Local Only Field"),e(a)])])]),R,n("ul",null,[n("li",null,[n("a",O,[s("Link"),e(a)])])]),U,n("blockquote",null,[n("p",null,[s("Apollo Client æœƒè‡ªå‹• queries æ¯å€‹ç‰©ä»¶çš„ __typename, å³ä½¿ä½ æ²’æœ‰æä¾›åœ¨ query è«‹æ±‚ä¸­ï¼Œåˆ‡è¨˜ "),E,s("ï¼Œå¦‚æœæœ‰éœ€è¦æ›´æ–° cacheï¼Œè«‹åƒè€ƒ"),n("a",$,[s("Combining reads and writes"),e(a)])])]),B,n("ul",null,[n("li",null,[n("a",W,[s("Link"),e(a)]),s(" use "),z,s(", "),J,s(" to combine usage with "),H])]),K])}const sn=p(i,[["render",X],["__file","apollo-client.html.vue"]]);export{sn as default};
