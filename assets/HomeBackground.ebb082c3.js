import{_ as G,B as h,A as V,C as J,m as K,o as Q,c as Z,d as A}from"./app.a6b87ec6.js";const D={class:"home-background"},x=30,H=10,I=.1,T={__name:"HomeBackground",setup(ee){var O,b;const N=(e,o=!1)=>new Promise(n=>{const s=document.createElement("img");s.src=e,s.crossOrigin=o?"anonymous":!1,s.onload=()=>n(s)}),Y=(e,o,n,s)=>{const t=e-n,a=o-s,r=Math.sqrt(t**2+a**2);return{x:t,y:a,distance:r}},S=(e,o,n,s,t=4)=>{const a=n+t,r=s+t,c=t*t;let u=0,v=0,d=0,m=0;for(let P=n;P<a;P++)for(let X=s;X<r;X++){const p=(P*o+X)*4;u+=e[p],v+=e[p+1],d+=e[p+2],m+=e[p+3]}const R=u/c,E=v/c,q=d/c,W=m/c;return{x:s+t/2,y:n+t/2,originX:s+t/2,originY:n+t/2,color:`rgba(${R}, ${E}, ${q}, ${W/255})`}},i=h(null),L=h(null),M=h([]),B=h({x:1/0,y:1/0}),F=h(1),f=h();let _,l=(O=i.value)==null?void 0:O.width,y=(b=i.value)==null?void 0:b.height;const $=e=>{const o=Math.round(y/x),n=Math.round(l/x),s=[];for(let t=0;t<o;t++)for(let a=0;a<n;a++){const r=t*x,c=a*x,u=S(e,l,r,c,x);s.push(u)}return s},z=()=>{const e=L.value;e.clearRect(0,0,l,y),M.value.forEach(o=>{e.beginPath(),e.arc(o.x,o.y,x/2,0,Math.PI*2),e.fillStyle=o.color,e.fill()})},U=()=>{const e=M.value,o=B.value,{x:n,y:s}=o;e.forEach(t=>{const{x:a,y:r,distance:c}=Y(n,s,t.x,t.y);if(c<_){const u=(_-c)/_,v=Math.atan2(r,a),d=Math.cos(v)*u*H,m=Math.sin(v)*u*H;t.x-=d,t.y-=m}else if(t.x!==t.originX||t.y!==t.originY){const{x:u,y:v,distance:d}=Y(t.originX,t.originY,t.x,t.y),m=Math.atan2(v,u),R=Math.cos(m)*d*I,E=Math.sin(m)*d*I;t.x+=R,t.y+=E}})},k=()=>{U(),z(),requestAnimationFrame(k)},j=async e=>{const o=await N(e,!0),{width:n,height:s}=o,t=i.value;f.value=t.getBoundingClientRect(),F.value=n/f.value.width,l=t.width=n,y=t.height=s;const a=L.value;a.drawImage(o,0,0,l,y);const r=a.getImageData(0,0,l,y),c=$(r.data);M.value=c,k()},g=e=>{var a;const o=F.value,n=(a=e==null?void 0:e.touches)==null?void 0:a[0],s=f.value.top,t=f.value.left;B.value={x:((n==null?void 0:n.pageX)-t||e.offsetX)*o,y:((n==null?void 0:n.pageY)-s||e.offsetY)*o}},w=()=>{B.value={x:1/0,y:1/0}},C=()=>{const e=i.value;f.value=e.getBoundingClientRect(),F.value=l/f.value.width};return V(i,()=>{const e=i.value;e&&(e.addEventListener("mousemove",g,{passive:!0}),e.addEventListener("mouseleave",w),e.addEventListener("touchstart",g,{passive:!0}),e.addEventListener("touchmove",g,{passive:!0}),e.addEventListener("touchend",w,{passive:!0}),window.addEventListener("resize",C,{passive:!0}))}),J(()=>{const e=i.value;e&&(e.removeEventListener("mousemove",g),e.removeEventListener("mouseleave",w),e.removeEventListener("touchstart",g),e.removeEventListener("touchmove",g),e.removeEventListener("touchend",w),window.removeEventListener("resize",C))}),K(()=>{_=window.innerWidth<576?300:200;const e=i.value;e&&(L.value=e.getContext("2d"),j("https://raw.githubusercontent.com/jwlearn1994/image-uploader/main/others/myblog/me2.jpeg"))}),(e,o)=>(Q(),Z("div",D,[A("canvas",{ref_key:"canvasRef",ref:i,style:{width:"100%"}},null,512)]))}},ne=G(T,[["__file","HomeBackground.vue"]]);export{ne as default};
