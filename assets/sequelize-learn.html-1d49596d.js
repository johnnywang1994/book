import{_ as p,r as o,o as c,c as l,d as n,e as a,a as e,f as t}from"./app-6ffe09b2.js";const i={},r=t(`<h1 id="sequelize-筆記" tabindex="-1"><a class="header-anchor" href="#sequelize-筆記" aria-hidden="true">#</a> Sequelize 筆記</h1><h2 id="基本使用" tabindex="-1"><a class="header-anchor" href="#基本使用" aria-hidden="true">#</a> 基本使用</h2><p>建議透過 <code>sequelize-cli</code> 快速搭建環境配置，以及構建完整 models, migrations 環境</p><p>以 Koa 舉例，安裝如下</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token function">npm</span> <span class="token function">install</span> sequelize sequelize-cli sqlite3 koa koa-body @koa/router
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="初始化" tabindex="-1"><a class="header-anchor" href="#初始化" aria-hidden="true">#</a> 初始化</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ npx sequelize init
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="創建-model" tabindex="-1"><a class="header-anchor" href="#創建-model" aria-hidden="true">#</a> 創建 model</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ npx sequelize model:generate <span class="token parameter variable">--name</span> office <span class="token parameter variable">--attributes</span> name:string
$ npx sequelize model:generate <span class="token parameter variable">--name</span> lesson <span class="token parameter variable">--attributes</span> name:string
$ npx sequelize model:generate <span class="token parameter variable">--name</span> teacher <span class="token parameter variable">--attributes</span> name:string, officeId:integer
$ npx sequelize model:generate <span class="token parameter variable">--name</span> teacher_lesson <span class="token parameter variable">--attributes</span> lessonId:integer,teacherId:integer
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="修改-migration" tabindex="-1"><a class="header-anchor" href="#修改-migration" aria-hidden="true">#</a> 修改 migration</h2>`,10),u={href:"https://siddharth-lakhara.medium.com/understanding-sequelize-associations-part-3-many-to-many-n-m-mapping-3e7dcdeb78db",target:"_blank",rel:"noopener noreferrer"},d=t(`<ol><li><code>teacher</code> 1 to many relation 修改 teacher 的 migration file 加上 references</li></ol><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">up</span><span class="token punctuation">(</span><span class="token parameter">queryInterface<span class="token punctuation">,</span> Sequelize</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> queryInterface<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;teachers&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...</span>
      <span class="token literal-property property">officeId</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> Sequelize<span class="token punctuation">.</span><span class="token constant">INTEGER</span><span class="token punctuation">,</span>
        <span class="token literal-property property">references</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token string">&#39;offices&#39;</span><span class="token punctuation">,</span> <span class="token comment">// need to be pluralized in migration</span>
          <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><code>teacher_lesson</code> M to N relation 修改 teacher_lesson 的 migration file 加上 references</li></ol><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">up</span><span class="token punctuation">(</span><span class="token parameter">queryInterface<span class="token punctuation">,</span> Sequelize</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> queryInterface<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">&#39;teacher_lessons&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...</span>
      <span class="token literal-property property">lessonId</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> Sequelize<span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">,</span>
        <span class="token literal-property property">references</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token string">&#39;lessons&#39;</span><span class="token punctuation">,</span> <span class="token comment">// need to be pluralized in migration</span>
          <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">&#39;id&#39;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">teacherId</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> Sequelize<span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">,</span>
        <span class="token literal-property property">references</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token string">&#39;teachers&#39;</span><span class="token punctuation">,</span> <span class="token comment">// need to be pluralized in migration</span>
          <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">&#39;id&#39;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="添加-model-relations" tabindex="-1"><a class="header-anchor" href="#添加-model-relations" aria-hidden="true">#</a> 添加 model relations</h2><p>model relation 關係按照以下方式判讀</p>`,6),k={href:"https://sequelize.org/docs/v6/core-concepts/assocs/",target:"_blank",rel:"noopener noreferrer"},v={href:"https://sequelize.org/v5/manual/associations.html",target:"_blank",rel:"noopener noreferrer"},m=t(`<ol><li><code>A.belongsTo(B)</code></li></ol><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// A 屬於 B</span>
<span class="token constant">A</span><span class="token punctuation">.</span><span class="token function">belongsTo</span><span class="token punctuation">(</span><span class="token constant">B</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">foreignKey</span><span class="token operator">:</span> <span class="token string">&#39;B_Id&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 在 A 上添加 B 的 foreignKey</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><code>A.belongsToMany(B)</code> 以下為預設的 belongsToMany 行為，會自動添加兩方的 id 為 foreignKey</li></ol><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// A 屬於多個 B</span>
<span class="token constant">A</span><span class="token punctuation">.</span><span class="token function">belongsToMany</span><span class="token punctuation">(</span><span class="token constant">B</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">through</span><span class="token operator">:</span> <span class="token string">&#39;A_B&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">foreignKey</span><span class="token operator">:</span> <span class="token string">&#39;A_Id&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 在 A_B 上添加 source A 的 foreignKey</span>
  <span class="token literal-property property">otherKey</span><span class="token operator">:</span> <span class="token string">&#39;B_Id&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 在 A_B 上添加 target B 的 foreignKey</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><code>A.hasOne(B), A.hasMany(B)</code> 因為 A, B 關係是成對存在，建議以一種方式添加 foreignKey 即可，例如 belongsTo 已經添加，則對應的 hasOne 或 hasMany 就可以省略</li></ol><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// A 擁有多個 B</span>
<span class="token constant">A</span><span class="token punctuation">.</span><span class="token function">hasMany</span><span class="token punctuation">(</span><span class="token constant">B</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">foreignKey</span><span class="token operator">:</span> <span class="token string">&#39;B_Id&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 在 B 上添加 A 的 foreignKey</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="按照上述規則添加-model-relations" tabindex="-1"><a class="header-anchor" href="#按照上述規則添加-model-relations" aria-hidden="true">#</a> 按照上述規則添加 model relations</h2><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// office model</span>
<span class="token comment">// foreignKey 在 teacher 的 belongsTo 添加</span>
office<span class="token punctuation">.</span><span class="token function">hasMany</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>teacher<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// lesson model</span>
lesson<span class="token punctuation">.</span><span class="token function">belongsToMany</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>teacher<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">through</span><span class="token operator">:</span> models<span class="token punctuation">.</span>teacher_lesson<span class="token punctuation">,</span>
  <span class="token literal-property property">foreignKey</span><span class="token operator">:</span> <span class="token string">&#39;lessonId&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// teacher model</span>
teacher<span class="token punctuation">.</span><span class="token function">belongsTo</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>office<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">foreignKey</span><span class="token operator">:</span> <span class="token string">&#39;officeId&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

teacher<span class="token punctuation">.</span><span class="token function">belongsToMany</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>lesson<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">through</span><span class="token operator">:</span> models<span class="token punctuation">.</span>teacher_lesson<span class="token punctuation">,</span>
  <span class="token literal-property property">foreignKey</span><span class="token operator">:</span> <span class="token string">&#39;teacherId&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// teacher_lesson model</span>
teacher_lesson<span class="token punctuation">.</span><span class="token function">belongsTo</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>lesson<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">foreignKey</span><span class="token operator">:</span> <span class="token string">&#39;lessonId&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
teacher_lesson<span class="token punctuation">.</span><span class="token function">belongsTo</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>teacher<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">foreignKey</span><span class="token operator">:</span> <span class="token string">&#39;teacherId&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="更新-config-json-配置" tabindex="-1"><a class="header-anchor" href="#更新-config-json-配置" aria-hidden="true">#</a> 更新 config.json 配置</h2><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;development&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;storage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./db.sqlite&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;dialect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sqlite&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="migrate-models" tabindex="-1"><a class="header-anchor" href="#migrate-models" aria-hidden="true">#</a> migrate models</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ npx sequelize db:migrate
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="建立-koa-server" tabindex="-1"><a class="header-anchor" href="#建立-koa-server" aria-hidden="true">#</a> 建立 koa server</h2><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;koa&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> KoaRouter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;@koa/router&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;koa-body&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KoaRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">prefix</span><span class="token operator">:</span> <span class="token string">&#39;/api&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">&#39;welcome&#39;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// ... apis</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;server listen 8000&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="db-manager-筆記" tabindex="-1"><a class="header-anchor" href="#db-manager-筆記" aria-hidden="true">#</a> db manager 筆記</h2><ol><li>createTeacherLesson 建立一筆 中間表 的紀錄</li></ol><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">createTeacherLesson</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">lessonId<span class="token punctuation">,</span> teacherId</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> models<span class="token punctuation">.</span>teacher_lesson<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    lessonId<span class="token punctuation">,</span>
    teacherId<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>getTLsByTeacher 拿取指定 teacher 並包含其所有 lessons</li></ol><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">getTLsByTeacher</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">teacherId</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> models<span class="token punctuation">.</span>teacher<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> teacherId <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">include</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">model</span><span class="token operator">:</span> models<span class="token punctuation">.</span>lesson<span class="token punctuation">,</span>
      <span class="token comment">// exclude associate select</span>
      <span class="token comment">// https://stackoverflow.com/questions/30082625/cant-exclude-associations-fields-from-select-statement-in-sequelize</span>
      <span class="token literal-property property">through</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">attributes</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="reference" tabindex="-1"><a class="header-anchor" href="#reference" aria-hidden="true">#</a> Reference</h2>`,23),b={href:"https://github.com/jwlearn1994/koa-sequelize.git",target:"_blank",rel:"noopener noreferrer"};function h(g,y){const s=o("ExternalLinkIcon");return c(),l("div",null,[r,n("ul",null,[n("li",null,[n("a",u,[a("參考文章"),e(s)])])]),d,n("ul",null,[n("li",null,[n("a",k,[a("v6 associations"),e(s)])]),n("li",null,[n("a",v,[a("v5 associations"),e(s)])])]),m,n("ul",null,[n("li",null,[n("a",b,[a("Koa Sequelize"),e(s)])])])])}const _=p(i,[["render",h],["__file","sequelize-learn.html.vue"]]);export{_ as default};
